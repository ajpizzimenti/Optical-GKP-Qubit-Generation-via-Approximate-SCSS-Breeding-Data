(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    298045,       6981]
NotebookOptionsPosition[    290061,       6866]
NotebookOutlinePosition[    290489,       6883]
CellTagsIndexPosition[    290446,       6880]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Bloch-Messiah Decompositions", "Title",
 CellChangeTimes->{{3.931458853114903*^9, 3.931458867410377*^9}, {
  3.942410294995078*^9, 3.942410295187147*^9}, {3.942410963247913*^9, 
  3.942410967117785*^9}, {3.942509671156186*^9, 
  3.942509679302946*^9}},ExpressionUUID->"5911a561-237d-4ae9-b765-\
4585e1555d14"],

Cell["\<\
The entire optical circuit that generates GPS breeding w/ post selection \
output states (the GPS state generation, breeding, and damping operation) can \
be simplified to an optical circuit with squeezed vacuum inputs operated on \
with passive Gaussian optics using Bloch-Messiah decomposition. Here we \
perform the Bloch-Messiah decomposition to find the input squeezing values \
and passive Gaussian circuit parameters needed to produce each of the final \
output states. \
\>", "Text",
 CellChangeTimes->{{3.942509846275928*^9, 3.942509863579225*^9}, {
  3.942509894355262*^9, 3.9425100193796873`*^9}, {3.942510071311657*^9, 
  3.942510072150444*^9}},ExpressionUUID->"675ed024-5276-4b1a-bb78-\
9c3a0477396e"],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.923139292018195*^9, 3.923139306776127*^9}, {
  3.925411592025882*^9, 
  3.9254115932542686`*^9}},ExpressionUUID->"5f477446-0204-44e2-a5b3-\
20b32f4aff3a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TwoModeOutProb", "[", 
    RowBox[{"n_", ",", "\[Sigma]_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "P", ",", " ", "\[Sigma]12", ",", " ", "\[Sigma]22", ",", " ", 
       "\[Sigma]det"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Sigma]det", " ", "=", " ", 
       RowBox[{"Det", "[", "\[Sigma]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]12", " ", "=", " ", 
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"\[Sigma]22", " ", "=", " ", 
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"P", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Factorial", "[", 
           RowBox[{"2", "*", "n"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["8", "n"], 
            SuperscriptBox[
             RowBox[{"Factorial", "[", "n", "]"}], "2"]}], ")"}]}], ")"}], 
        RowBox[{"Sqrt", "[", "\[Sigma]det", "]"}], "*", 
        SuperscriptBox["\[Sigma]12", 
         RowBox[{"2", "*", "n"}]], "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"\[Sigma]det", "+", "\[Sigma]22"}], ")"}]}], ")"}], 
         RowBox[{
          RowBox[{"-", "n"}], "-", 
          FractionBox["1", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "P", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoModeOutWF", "[", 
    RowBox[{"n_", ",", "\[Sigma]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Psi]", ",", " ", "\[Sigma]12", ",", " ", "\[Sigma]22", ",", " ", 
       "\[Sigma]det"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Sigma]det", " ", "=", " ", 
       RowBox[{"Det", "[", "\[Sigma]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]12", " ", "=", " ", 
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"\[Sigma]22", " ", "=", " ", 
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"\[Psi]", " ", "=", " ", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "/", "Pi"}], ")"}], 
         FractionBox["1", "4"]], "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "2"}], ")"}], "n"], "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"Factorial", "[", "n", "]"}], "/", 
          RowBox[{"Factorial", "[", 
           RowBox[{"2", "*", "n"}], "]"}]}], "]"}], "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"\[Sigma]det", " ", "+", " ", "\[Sigma]22"}], ")"}]}], 
          ")"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "*", "n"}], "+", "1"}], ")"}], "/", "4"}]], "*", 
        SuperscriptBox["x", "n"], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "4"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"\[Sigma]det", "+", "\[Sigma]22"}], ")"}]}], ")"}], 
          SuperscriptBox["x", "2"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "\[Psi]", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SqVacCoVar", "[", "rVec_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}], "*", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"Exp", "[", 
      RowBox[{"2", "*", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"rVec", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "*", "rVec"}]}], "}"}], "]"}]}], "]"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DisplacedSqueezedMoments", "[", 
    RowBox[{"alphaVec_", ",", " ", "xiVec_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "V", ",", " ", "r", ",", " ", "phi"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", " ", "=", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Re", "[", "xiVec", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"Im", "[", "xiVec", "]"}], "2"]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phi", " ", "=", 
       RowBox[{"Arg", "[", "xiVec", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Sqrt", "[", "2", "]"}], "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Re", "[", "alphaVec", "]"}], ",", 
           RowBox[{"Im", "[", "alphaVec", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"V", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], "*", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DiagonalMatrix", "[", 
              RowBox[{
               RowBox[{"Cosh", "[", 
                RowBox[{"2", "r"}], "]"}], "+", 
               RowBox[{
                RowBox[{"Sinh", "[", 
                 RowBox[{"2", "r"}], "]"}], "*", 
                RowBox[{"Cos", "[", "phi", "]"}]}]}], "]"}], ",", " ", 
             RowBox[{"-", 
              RowBox[{"DiagonalMatrix", "[", 
               RowBox[{
                RowBox[{"Sinh", "[", 
                 RowBox[{"2", "*", "r"}], "]"}], "*", 
                RowBox[{"Sin", "[", "phi", "]"}]}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"DiagonalMatrix", "[", 
               RowBox[{
                RowBox[{"Sinh", "[", 
                 RowBox[{"2", "*", "r"}], "]"}], "*", 
                RowBox[{"Sin", "[", "phi", "]"}]}], "]"}]}], ",", 
             RowBox[{"DiagonalMatrix", "[", 
              RowBox[{
               RowBox[{"Cosh", "[", 
                RowBox[{"2", "r"}], "]"}], "-", 
               RowBox[{
                RowBox[{"Sinh", "[", 
                 RowBox[{"2", "r"}], "]"}], "*", 
                RowBox[{"Cos", "[", "phi", "]"}]}]}], "]"}]}], "}"}]}], "}"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"d", ",", "V"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSTransform", "[", 
    RowBox[{"N_", ",", "n_", ",", "m_", ",", "tau_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "s", ",", "M"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"M", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Sqrt", "[", "tau", "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sqrt", "[", "tau", "]"}]}], ",", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "-", "tau"}], "]"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"IdentityMatrix", "[", "N", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"n", ",", "n"}], "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "tau"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"n", ",", "m"}], "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Sqrt", "[", "tau", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "n"}], "]"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", "tau", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "m"}], "]"}], "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "tau"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"S", " ", "=", " ", 
       RowBox[{
        RowBox[{"ArrayPad", "[", 
         RowBox[{"s", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "N"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "N"}], "}"}]}], "}"}]}], "]"}], "+", 
        RowBox[{"ArrayPad", "[", 
         RowBox[{"s", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N", ",", "0"}], "}"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "S", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OmegaCreate", "[", "Modes_", "]"}], ":=", " ", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"IdentityMatrix", "[", "Modes", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolarDecomposition", "[", "mat_", "]"}], "/;", 
   RowBox[{"MatrixQ", "[", 
    RowBox[{"mat", ",", "NumericQ"}], "]"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Last", "[", 
        RowBox[{"Dimensions", "[", "mat", "]"}], "]"}]}], ",", 
      RowBox[{"prec", "=", 
       RowBox[{"Internal`EffectivePrecision", "[", "mat", "]"}]}], ",", "cv", 
      ",", "u", ",", "s", ",", "v"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u", ",", "s", ",", "v"}], "}"}], "=", 
        RowBox[{"SingularValueDecomposition", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"mat", ",", "prec"}], "]"}], ",", 
          RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cv", "=", 
        RowBox[{"ConjugateTranspose", "[", "v", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"u", ",", "All", ",", "n"}], "]"}], ".", "cv"}], ",", 
         RowBox[{"v", ".", 
          RowBox[{"Take", "[", 
           RowBox[{"s", ",", "n"}], "]"}], ".", "cv"}]}], "}"}]}], ")"}], "/;", 
     RowBox[{"prec", "<", "\[Infinity]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TCreate", "[", 
    RowBox[{"N_", ",", "n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "T", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", " ", "=", " ", 
       RowBox[{"IdentityMatrix", "[", "N", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", 
         RowBox[{"n", ",", "n"}], "]"}], "]"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"I", "*", "phi"}], "]"}], "*", 
        RowBox[{"Cos", "[", "theta", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", 
         RowBox[{"n", ",", "m"}], "]"}], "]"}], " ", "=", " ", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "theta", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "n"}], "]"}], "]"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"I", "*", "phi"}], "]"}], "*", 
        RowBox[{"Sin", "[", "theta", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "m"}], "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Cos", "[", "theta", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "T", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitaryDecomp", "[", "U_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"phi", ",", "theta", ",", "r"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", " ", "=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "/", 
        RowBox[{"U", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"theta", " ", "=", " ", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"Abs", "[", "r", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phi", " ", "=", 
       RowBox[{"Arg", "[", "r", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"phi", ",", "theta"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Enumerate", "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xCon", ",", "Output"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xCon", " ", "=", " ", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "x", "]"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Output", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], ",", 
           RowBox[{"xCon", "[", 
            RowBox[{"[", "ii", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "Output", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nullTi", "[", 
    RowBox[{"ii_", ",", "jj_", ",", "Eles_", ",", "U_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "theta", ",", "phi", ",", "nmax", ",", "r", ",", "n", ",", "m", ",", 
       " ", "CurrentEle"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"ii", "-", "jj"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"ii", "-", "jj", "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nmax", " ", "=", " ", 
       RowBox[{
        RowBox[{"Dimensions", "[", "U", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"theta", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CurrentEle", "=", 
       RowBox[{"Eles", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", 
          RowBox[{"jj", "+", "1"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"U", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"CurrentEle", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"CurrentEle", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "]"}], "==", 
         "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"theta", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"phi", " ", "=", " ", "0"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"U", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"CurrentEle", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"CurrentEle", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], "]"}], "]"}], 
          "]"}], "==", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"theta", " ", "=", " ", 
          RowBox[{"Pi", "/", "2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"phi", " ", "=", " ", "0"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "theta", "]"}], "==", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", " ", "=", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"CurrentEle", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"CurrentEle", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "/", 
           RowBox[{"U", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"CurrentEle", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"CurrentEle", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], "]"}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"theta", " ", "=", " ", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"Abs", "[", "r", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phi", " ", "=", 
          RowBox[{"Arg", "[", "r", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "m", ",", "phi", ",", "theta", ",", "nmax"}], "}"}],
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nullT", "[", 
    RowBox[{"ii_", ",", "jj_", ",", "Eles_", ",", "U_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "theta", ",", "phi", ",", "nmax", ",", "r", ",", "n", ",", "m", ",", 
       "CurrentEle"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nmax", " ", "=", " ", 
       RowBox[{
        RowBox[{"Dimensions", "[", "U", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"nmax", "+", "jj", "-", "ii", "-", "1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"nmax", "+", "jj", "-", "ii"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"theta", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CurrentEle", "=", 
       RowBox[{"Eles", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "jj"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"U", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"CurrentEle", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"CurrentEle", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "]"}], "==", 
         "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"theta", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"phi", " ", "=", " ", "0"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"U", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{"CurrentEle", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", 
             RowBox[{"CurrentEle", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "]"}], "==", 
         "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"theta", " ", "=", " ", 
          RowBox[{"Pi", "/", "2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"phi", " ", "=", " ", "0"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "theta", "]"}], "==", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", " ", "=", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"CurrentEle", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"CurrentEle", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "/", 
           RowBox[{"U", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"CurrentEle", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", 
              RowBox[{"CurrentEle", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"theta", " ", "=", " ", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"Abs", "[", "r", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phi", " ", "=", 
          RowBox[{"Arg", "[", "r", "]"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "m", ",", "phi", ",", "theta", ",", "nmax"}], "}"}],
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{
    "n_", ",", "m_", ",", " ", "phi_", ",", "theta_", ",", " ", "nmax_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "mat", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mat", "=", 
       RowBox[{"IdentityMatrix", "[", "nmax", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mat", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "m"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"I", "*", "phi"}], "]"}], "*", 
        RowBox[{"Cos", "[", "theta", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mat", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "n"}], "]"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "theta", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mat", "[", 
        RowBox[{"[", 
         RowBox[{"n", ",", "m"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"I", "*", "phi"}], "]"}], "*", 
        RowBox[{"Sin", "[", "theta", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mat", "[", 
        RowBox[{"[", 
         RowBox[{"n", ",", "n"}], "]"}], "]"}], "=", 
       RowBox[{"Cos", "[", "theta", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "mat", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ti", "[", 
    RowBox[{
    "n_", ",", "m_", ",", " ", "phi_", ",", "theta_", ",", " ", "nmax_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "mat", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mat", "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"T", "[", 
         RowBox[{
         "n", ",", "m", ",", " ", "phi", ",", "theta", ",", " ", "nmax"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "mat", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rectangular", "[", "U_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tilist", ",", "tlist", ",", "localU", ",", "nsize", ",", "Eles", ",", 
       "TempH"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"localU", " ", "=", " ", "U"}], ";", "\[IndentingNewLine]", 
      RowBox[{"nsize", " ", "=", " ", 
       RowBox[{
        RowBox[{"Dimensions", "[", "U", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Eles", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"nsize", ",", "2"}], "]"}], "!=", "0"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"kk", ",", "2"}], "]"}], "!=", "0"}], ",", 
             RowBox[{"Diagonal", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"LowerTriangularize", "[", 
                    RowBox[{
                    RowBox[{"ArrayReshape", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    SuperscriptBox["nsize", "2"], ",", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nsize", ",", "nsize"}], "}"}]}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "!=", " ", "0"}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"ii", ",", "jj"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"ii", ",", "1", ",", "nsize"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"jj", ",", "1", ",", "nsize"}], "}"}]}], "]"}], ",", 
               RowBox[{"-", "kk"}]}], "]"}], ",", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Diagonal", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"LowerTriangularize", "[", 
                    RowBox[{
                    RowBox[{"ArrayReshape", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    SuperscriptBox["nsize", "2"], ",", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nsize", ",", "nsize"}], "}"}]}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "!=", " ", "0"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"ii", ",", "jj"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"ii", ",", "1", ",", "nsize"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"jj", ",", "1", ",", "nsize"}], "}"}]}], "]"}], 
                ",", 
                RowBox[{"-", "kk"}]}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"kk", ",", 
             RowBox[{"nsize", "-", "1"}], ",", "1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"kk", ",", "2"}], "]"}], "==", "0"}], ",", 
             RowBox[{"Diagonal", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"LowerTriangularize", "[", 
                    RowBox[{
                    RowBox[{"ArrayReshape", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    SuperscriptBox["nsize", "2"], ",", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nsize", ",", "nsize"}], "}"}]}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "!=", " ", "0"}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"ii", ",", "jj"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"ii", ",", "1", ",", "nsize"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"jj", ",", "1", ",", "nsize"}], "}"}]}], "]"}], ",", 
               RowBox[{"-", "kk"}]}], "]"}], ",", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Diagonal", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"LowerTriangularize", "[", 
                    RowBox[{
                    RowBox[{"ArrayReshape", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    SuperscriptBox["nsize", "2"], ",", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nsize", ",", "nsize"}], "}"}]}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "!=", " ", "0"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"ii", ",", "jj"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"ii", ",", "1", ",", "nsize"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"jj", ",", "1", ",", "nsize"}], "}"}]}], "]"}], 
                ",", 
                RowBox[{"-", "kk"}]}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"kk", ",", 
             RowBox[{"nsize", "-", "1"}], ",", "1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tilist", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tlist", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ii", "=", "1"}], ",", " ", 
        RowBox[{"ii", "<=", 
         RowBox[{"nsize", "-", "1"}]}], ",", 
        RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"ii", ",", "2"}], "]"}], "!=", " ", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"jj", "=", "0"}], ",", 
             RowBox[{"jj", "<=", 
              RowBox[{"ii", "-", "1"}]}], ",", 
             RowBox[{"jj", "++"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ii", "==", "3"}], "&&", 
                 RowBox[{"jj", "==", "1"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"TempH", " ", "=", " ", 
                  RowBox[{"nullTi", "[", 
                   RowBox[{"ii", ",", "jj", ",", "Eles", ",", "localU"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"TempH", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "=", "0"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"tilist", ",", "TempH"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"localU", " ", "=", " ", 
                  RowBox[{"localU", ".", 
                   RowBox[{"Ti", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}]}], ";"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"tilist", ",", 
                   RowBox[{"nullTi", "[", 
                    RowBox[{"ii", ",", "jj", ",", "Eles", ",", "localU"}], 
                    "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"localU", " ", "=", " ", 
                  RowBox[{"localU", ".", 
                   RowBox[{"Ti", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}]}], ";"}]}], 
               "]"}], ";"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"tilist", ",", 
                RowBox[{"nullTi", "[", 
                 RowBox[{"ii", ",", "jj", ",", "Eles", ",", "localU"}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"localU", " ", "=", " ", 
               RowBox[{"localU", ".", 
                RowBox[{"Ti", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "4", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}]}], ";"}], "*)"}],
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"jj", "=", "1"}], ",", 
              RowBox[{"jj", "<=", "ii"}], ",", 
              RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"tlist", ",", 
                 RowBox[{"nullT", "[", 
                  RowBox[{"ii", ",", "jj", ",", "Eles", ",", "localU"}], 
                  "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"localU", " ", "=", " ", 
                RowBox[{
                 RowBox[{"T", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"tlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"tlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"tlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"tlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"tlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ".", 
                 "localU"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}],
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Reverse", "[", "tilist", "]"}], ",", 
         RowBox[{"Reverse", "[", "tlist", "]"}], ",", "localU"}], "}"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Rectangular3", "[", "U_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tilist", ",", "tlist", ",", "localU", ",", "nsize", ",", "Eles", ",", 
       "TempH"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"localU", " ", "=", " ", "U"}], ";", "\[IndentingNewLine]", 
      RowBox[{"nsize", " ", "=", " ", 
       RowBox[{
        RowBox[{"Dimensions", "[", "U", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Eles", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"nsize", ",", "2"}], "]"}], "!=", "0"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"kk", ",", "2"}], "]"}], "!=", "0"}], ",", 
             RowBox[{"Diagonal", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"LowerTriangularize", "[", 
                    RowBox[{
                    RowBox[{"ArrayReshape", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    SuperscriptBox["nsize", "2"], ",", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nsize", ",", "nsize"}], "}"}]}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "!=", " ", "0"}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"ii", ",", "jj"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"ii", ",", "1", ",", "nsize"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"jj", ",", "1", ",", "nsize"}], "}"}]}], "]"}], ",", 
               RowBox[{"-", "kk"}]}], "]"}], ",", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Diagonal", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"LowerTriangularize", "[", 
                    RowBox[{
                    RowBox[{"ArrayReshape", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    SuperscriptBox["nsize", "2"], ",", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nsize", ",", "nsize"}], "}"}]}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "!=", " ", "0"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"ii", ",", "jj"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"ii", ",", "1", ",", "nsize"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"jj", ",", "1", ",", "nsize"}], "}"}]}], "]"}], 
                ",", 
                RowBox[{"-", "kk"}]}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"kk", ",", 
             RowBox[{"nsize", "-", "1"}], ",", "1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"kk", ",", "2"}], "]"}], "==", "0"}], ",", 
             RowBox[{"Diagonal", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"LowerTriangularize", "[", 
                    RowBox[{
                    RowBox[{"ArrayReshape", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    SuperscriptBox["nsize", "2"], ",", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nsize", ",", "nsize"}], "}"}]}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "!=", " ", "0"}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"ii", ",", "jj"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"ii", ",", "1", ",", "nsize"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"jj", ",", "1", ",", "nsize"}], "}"}]}], "]"}], ",", 
               RowBox[{"-", "kk"}]}], "]"}], ",", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Diagonal", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"LowerTriangularize", "[", 
                    RowBox[{
                    RowBox[{"ArrayReshape", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    SuperscriptBox["nsize", "2"], ",", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nsize", ",", "nsize"}], "}"}]}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "!=", " ", "0"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"ii", ",", "jj"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"ii", ",", "1", ",", "nsize"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"jj", ",", "1", ",", "nsize"}], "}"}]}], "]"}], 
                ",", 
                RowBox[{"-", "kk"}]}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"kk", ",", 
             RowBox[{"nsize", "-", "1"}], ",", "1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tilist", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tlist", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ii", "=", "1"}], ",", " ", 
        RowBox[{"ii", "<=", 
         RowBox[{"nsize", "-", "1"}]}], ",", 
        RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"ii", ",", "2"}], "]"}], "!=", " ", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"jj", "=", "0"}], ",", 
             RowBox[{"jj", "<=", 
              RowBox[{"ii", "-", "1"}]}], ",", 
             RowBox[{"jj", "++"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ii", "==", "3"}], "&&", 
                 RowBox[{"jj", "==", "1"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"TempH", " ", "=", " ", 
                  RowBox[{"nullTi", "[", 
                   RowBox[{"ii", ",", "jj", ",", "Eles", ",", "localU"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"tilist", ",", "TempH"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"localU", " ", "=", " ", 
                  RowBox[{"localU", ".", 
                   RowBox[{"Ti", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}]}], ";"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"tilist", ",", 
                   RowBox[{"nullTi", "[", 
                    RowBox[{"ii", ",", "jj", ",", "Eles", ",", "localU"}], 
                    "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"localU", " ", "=", " ", 
                  RowBox[{"localU", ".", 
                   RowBox[{"Ti", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}]}], ";"}]}], 
               "]"}], ";"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"tilist", ",", 
                RowBox[{"nullTi", "[", 
                 RowBox[{"ii", ",", "jj", ",", "Eles", ",", "localU"}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"localU", " ", "=", " ", 
               RowBox[{"localU", ".", 
                RowBox[{"Ti", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "4", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"tilist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}]}], ";"}], "*)"}],
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"jj", "=", "1"}], ",", 
              RowBox[{"jj", "<=", "ii"}], ",", 
              RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"tlist", ",", 
                 RowBox[{"nullT", "[", 
                  RowBox[{"ii", ",", "jj", ",", "Eles", ",", "localU"}], 
                  "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"localU", " ", "=", " ", 
                RowBox[{
                 RowBox[{"T", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"tlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"tlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"tlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"tlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"tlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ".", 
                 "localU"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}],
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Reverse", "[", "tilist", "]"}], ",", 
         RowBox[{"Reverse", "[", "tlist", "]"}], ",", "localU"}], "}"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RectangularPhaseEnd", "[", "U_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "DD", ",", "tilist", ",", "tlist", ",", "diags", ",", "newtlist", ",", 
       "newdiags", ",", "em", ",", "en", ",", "newtheta", ",", " ", "newphi", 
       ",", "theta", ",", "phi", ",", "alpha", ",", "beta", ",", "CurrentT", 
       ",", "newCurrentT", ",", "nsize", ",", "newalpha", ",", "newbeta"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tilist", ",", "tlist", ",", "DD"}], "}"}], " ", "=", " ", 
       RowBox[{"Rectangular", "[", "U", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diags", " ", "=", " ", 
       RowBox[{"Diagonal", "[", "DD", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nsize", " ", "=", " ", 
       RowBox[{"Length", "[", "diags", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newtlist", " ", "=", " ", "tilist"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newdiags", " ", "=", " ", "diags"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tlist", " ", "=", " ", "tlist"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ii", "=", "1"}], ",", 
        RowBox[{"ii", "<=", 
         RowBox[{"Length", "[", "tlist", "]"}]}], ",", 
        RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CurrentT", " ", "=", " ", 
          RowBox[{"tlist", "[", 
           RowBox[{"[", "ii", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"em", "=", " ", 
          RowBox[{"CurrentT", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"en", "=", " ", 
          RowBox[{"CurrentT", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"alpha", " ", "=", " ", 
          RowBox[{"Arg", "[", 
           RowBox[{"newdiags", "[", 
            RowBox[{"[", "em", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"beta", " ", "=", " ", 
          RowBox[{"Arg", "[", 
           RowBox[{"newdiags", "[", 
            RowBox[{"[", "en", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phi", " ", "=", " ", 
          RowBox[{"CurrentT", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"theta", " ", "=", " ", 
          RowBox[{"CurrentT", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"newtheta", "=", "theta"}], ";", "\[IndentingNewLine]", 
         RowBox[{"newphi", "=", 
          RowBox[{"beta", "-", "alpha", "+", "Pi"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newalpha", "=", "alpha"}], ";", "\[IndentingNewLine]", 
         RowBox[{"newbeta", "=", 
          RowBox[{"alpha", "-", "phi", "+", "Pi"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newCurrentT", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"CurrentT", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"CurrentT", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "newphi", ",", "newtheta", 
            ",", "nsize"}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"PrependTo", "[", 
          RowBox[{"newtlist", ",", "newCurrentT"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newdiags", "[", 
           RowBox[{"[", "em", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", "*", "newalpha"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newdiags", "[", 
           RowBox[{"[", "en", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", "*", "newbeta"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"newtlist", ",", "newdiags"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rectangular3PhaseEnd", "[", "U_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "DD", ",", "tilist", ",", "tlist", ",", "diags", ",", "newtlist", ",", 
       "newdiags", ",", "em", ",", "en", ",", "newtheta", ",", " ", "newphi", 
       ",", "theta", ",", "phi", ",", "alpha", ",", "beta", ",", "CurrentT", 
       ",", "newCurrentT", ",", "nsize", ",", "newalpha", ",", "newbeta"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tilist", ",", "tlist", ",", "DD"}], "}"}], " ", "=", " ", 
       RowBox[{"Rectangular3", "[", "U", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"diags", " ", "=", " ", 
       RowBox[{"Diagonal", "[", "DD", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nsize", " ", "=", " ", 
       RowBox[{"Length", "[", "diags", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newtlist", " ", "=", " ", "tilist"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newdiags", " ", "=", " ", "diags"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tlist", " ", "=", " ", "tlist"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ii", "=", "1"}], ",", 
        RowBox[{"ii", "<=", 
         RowBox[{"Length", "[", "tlist", "]"}]}], ",", 
        RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CurrentT", " ", "=", " ", 
          RowBox[{"tlist", "[", 
           RowBox[{"[", "ii", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"em", "=", " ", 
          RowBox[{"CurrentT", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"en", "=", " ", 
          RowBox[{"CurrentT", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"alpha", " ", "=", " ", 
          RowBox[{"Arg", "[", 
           RowBox[{"newdiags", "[", 
            RowBox[{"[", "em", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"beta", " ", "=", " ", 
          RowBox[{"Arg", "[", 
           RowBox[{"newdiags", "[", 
            RowBox[{"[", "en", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phi", " ", "=", " ", 
          RowBox[{"CurrentT", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"theta", " ", "=", " ", 
          RowBox[{"CurrentT", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"newtheta", "=", "theta"}], ";", "\[IndentingNewLine]", 
         RowBox[{"newphi", "=", 
          RowBox[{"beta", "-", "alpha", "+", "Pi"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newalpha", "=", "alpha"}], ";", "\[IndentingNewLine]", 
         RowBox[{"newbeta", "=", 
          RowBox[{"alpha", "-", "phi", "+", "Pi"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newCurrentT", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"CurrentT", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"CurrentT", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "newphi", ",", "newtheta", 
            ",", "nsize"}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"PrependTo", "[", 
          RowBox[{"newtlist", ",", "newCurrentT"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newdiags", "[", 
           RowBox[{"[", "em", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", "*", "newalpha"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newdiags", "[", 
           RowBox[{"[", "en", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", "*", "newbeta"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"newtlist", ",", "newdiags"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9217821768786993`*^9, 3.921782265375496*^9}, {
   3.921782543448127*^9, 3.921782544376913*^9}, {3.921782684868931*^9, 
   3.921783239965098*^9}, {3.921783432523641*^9, 3.921783435310936*^9}, {
   3.921784420506331*^9, 3.921784465671636*^9}, {3.92178481545818*^9, 
   3.921784837985137*^9}, {3.9231484644601297`*^9, 3.92314847854556*^9}, {
   3.923591488537991*^9, 3.923591539320784*^9}, {3.923591581974906*^9, 
   3.923591599776662*^9}, {3.9235916309339943`*^9, 3.923591693795827*^9}, {
   3.9235917333689127`*^9, 3.9235918091773252`*^9}, {3.923591844324882*^9, 
   3.923591910730343*^9}, {3.923592584075053*^9, 3.923592586189234*^9}, {
   3.923595229237049*^9, 3.92359525455464*^9}, {3.923595289733347*^9, 
   3.9235953226638317`*^9}, {3.9236579844039917`*^9, 3.923657986096842*^9}, {
   3.925569126559815*^9, 3.925569126909412*^9}, {3.9260924205950947`*^9, 
   3.92609259471943*^9}, {3.926092844590581*^9, 3.926092935074197*^9}, {
   3.926093035875786*^9, 3.926093036065651*^9}, {3.926093092373272*^9, 
   3.926093137508925*^9}, {3.926093283861759*^9, 3.926093457419585*^9}, {
   3.9260934910569983`*^9, 3.9260936468502893`*^9}, {3.926093708037579*^9, 
   3.9260937971357107`*^9}, {3.926094086727558*^9, 3.926094117024865*^9}, {
   3.92609417238619*^9, 3.926094287788064*^9}, {3.926094333531863*^9, 
   3.926094337586973*^9}, {3.926094415949542*^9, 3.926094470755858*^9}, {
   3.926094504918501*^9, 3.926094646534292*^9}, {3.9260946819052677`*^9, 
   3.926094994538938*^9}, 3.926095027250217*^9, {3.926184618282118*^9, 
   3.9261846553781157`*^9}, {3.926184687200629*^9, 3.926184777684601*^9}, {
   3.926186261803754*^9, 3.926186357529092*^9}, {3.9261866908804407`*^9, 
   3.926186811979578*^9}, {3.9261875978070383`*^9, 3.926187626925447*^9}, {
   3.926187925914875*^9, 3.9261879407382193`*^9}, {3.926188471392579*^9, 
   3.9261884743588753`*^9}, {3.926189198815949*^9, 3.926189212394279*^9}, {
   3.9261893098549967`*^9, 3.926189313366501*^9}, {3.926189408202137*^9, 
   3.926189434549864*^9}, {3.926427589931489*^9, 3.926427672932228*^9}, {
   3.926427731537426*^9, 3.926427771033923*^9}, {3.926427919059136*^9, 
   3.926427919194435*^9}, {3.926428225449054*^9, 3.926428225841859*^9}, {
   3.926428378333644*^9, 3.9264284264742813`*^9}, {3.926428462877489*^9, 
   3.926428465427846*^9}, {3.926428522134927*^9, 3.9264285270729628`*^9}, {
   3.9264285875382233`*^9, 3.926428588257805*^9}, {3.926429691606064*^9, 
   3.9264296982501287`*^9}, 3.926429742628175*^9, {3.926439394092095*^9, 
   3.926439397557579*^9}, {3.92643994107446*^9, 3.926439946058779*^9}, {
   3.9264400731508007`*^9, 3.926440116709035*^9}, {3.926440227254601*^9, 
   3.926440236923523*^9}, {3.926445778920746*^9, 3.926445782473309*^9}, {
   3.926446744935039*^9, 3.9264467679070663`*^9}, {3.926447351364526*^9, 
   3.926447389108914*^9}, {3.926447436931447*^9, 3.926447512084197*^9}, {
   3.92644754841051*^9, 3.926447552311698*^9}, {3.9264475849587193`*^9, 
   3.926447586263495*^9}, {3.926447631886896*^9, 3.9264476637182217`*^9}, {
   3.926447698980506*^9, 3.926447700180622*^9}, {3.926448288828178*^9, 
   3.926448299561553*^9}, {3.926448641396565*^9, 3.926448651871126*^9}, {
   3.926449062441493*^9, 3.926449219347629*^9}, {3.9264492573160677`*^9, 
   3.9264492709052267`*^9}, 3.926507280728627*^9, {3.942759242495042*^9, 
   3.942759259463778*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"f47d3320-deba-4e1a-9cae-f32e041b24e7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving for relevant parameters", "Section",
 CellChangeTimes->{{3.923139292018195*^9, 3.923139306776127*^9}, {
  3.925411592025882*^9, 3.9254115932542686`*^9}, {3.942511676465081*^9, 
  3.9425116803610067`*^9}},ExpressionUUID->"98b08b24-455b-4fb6-92f6-\
7ba64d088018"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nSpace", " ", "=", " ", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"7", ",", "40"}], "]"}], ",", "37"}], "]"}], ",", "39"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.942751434262101*^9, 3.94275143523181*^9}, 
   3.942751823372753*^9},
 CellLabel->
  "In[125]:=",ExpressionUUID->"ae8de968-2903-4971-b437-809163889169"],

Cell["\<\
For each n, the squeezing (dB) that each GPS output state should have in \
order for breeding to result in proper GKP spacing is given in the following \
analytical form. Note that n > 7 for r \[Element] Reals  \
\>", "Text",
 CellChangeTimes->{{3.923138262913795*^9, 3.923138310837008*^9}, {
  3.923139208002829*^9, 3.923139225283452*^9}, {3.92313937372439*^9, 
  3.923139432145337*^9}, {3.9254116940901327`*^9, 3.925411788695139*^9}, {
  3.925411906715744*^9, 3.92541192296102*^9}, {3.942511730491387*^9, 
  3.942511744441369*^9}},ExpressionUUID->"6a095cbb-1b72-4abd-9292-\
6fb6ef5d7ab5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OptCatStateSqueezingdB", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nSpace", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"10", "*", 
        RowBox[{"Log10", "[", 
         RowBox[{"Exp", "[", 
          RowBox[{"ArcCosh", "[", 
           RowBox[{
            RowBox[{"nSpace", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "*", "Pi"}], ")"}]}], "]"}], "]"}], "]"}]}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.9254117544812527`*^9, {3.925411849027276*^9, 3.92541189312819*^9}, {
   3.9254120994237537`*^9, 3.925412099858512*^9}, {3.927219340871604*^9, 
   3.927219361223659*^9}, {3.927385754110243*^9, 3.927385762987597*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"99a086a2-9ca6-4efb-a955-0143208e0de2"],

Cell["\<\
The squeezing (dB) that gives maximum probability for each number of photons \
detected (n) in the GPS set up is   \
\>", "Text",
 CellChangeTimes->{{3.923138262913795*^9, 3.923138310837008*^9}, {
   3.923139208002829*^9, 3.923139225283452*^9}, {3.92313937372439*^9, 
   3.9231394586792707`*^9}, {3.923139556613721*^9, 3.923139701274169*^9}, {
   3.923139899556759*^9, 3.923139946625246*^9}, {3.923140033144418*^9, 
   3.923140036670156*^9}, {3.923140078595244*^9, 3.923140108924652*^9}, {
   3.9231402306471*^9, 3.923140426126731*^9}, {3.923316934119651*^9, 
   3.923316935795115*^9}, {3.924957178416772*^9, 3.9249573296875973`*^9}, {
   3.9254119930299587`*^9, 3.925411997766634*^9}, 3.9254120823989277`*^9, {
   3.9425114237720823`*^9, 3.9425114375151997`*^9}, {3.942511765504019*^9, 
   3.942511770090385*^9}},ExpressionUUID->"f8bb3946-d093-4c87-b864-\
e8c3aadd8fad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MaxGPSProbSqueezingdB", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"10", "*", 
      RowBox[{"Log10", "[", 
       RowBox[{"Exp", "[", 
        RowBox[{"ArcSech", "[", 
         FractionBox["1", 
          RowBox[{"1", "+", 
           RowBox[{"2", "*", 
            RowBox[{"nSpace", "[", 
             RowBox[{"[", "ii", "]"}], "]"}]}]}]], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.942511150816759*^9, 3.9425111823181973`*^9}, {
   3.94251130508144*^9, 3.942511315475387*^9}, {3.9425113545929813`*^9, 
   3.9425113670318403`*^9}, 3.942751690152164*^9, {3.942751755714224*^9, 
   3.9427517755442944`*^9}, 3.94275182935548*^9},
 CellLabel->
  "In[127]:=",ExpressionUUID->"0dc0bbf0-2dbd-44d7-8108-6cb989387435"],

Cell["\<\
If the state after PNR has squeezing r1 and we unsqueeze by r2,  r2 must \
follow the equation below for the unsqueezed state to be a GPS state with \
some target squeezing r,\
\>", "Text",
 CellChangeTimes->{{3.923138262913795*^9, 3.923138310837008*^9}, {
   3.923139208002829*^9, 3.923139225283452*^9}, {3.92313937372439*^9, 
   3.9231394586792707`*^9}, {3.923139556613721*^9, 3.923139701274169*^9}, {
   3.923139899556759*^9, 3.923139946625246*^9}, {3.923140033144418*^9, 
   3.923140036670156*^9}, {3.923140078595244*^9, 3.923140108924652*^9}, {
   3.9231402306471*^9, 3.923140426126731*^9}, {3.923146988144936*^9, 
   3.923147047411865*^9}, {3.9233206024384613`*^9, 3.9233206207250633`*^9}, {
   3.923762545537423*^9, 3.9237626502228107`*^9}, {3.923762711739785*^9, 
   3.9237627139745493`*^9}, {3.9237642870084133`*^9, 
   3.9237642976112537`*^9}, {3.92541250679567*^9, 3.925412540290926*^9}, {
   3.92547241312761*^9, 3.925472441151011*^9}, 3.925472754166995*^9, {
   3.925473125117536*^9, 3.925473176620142*^9}, {3.925473246428997*^9, 
   3.9254733886871634`*^9}, {3.942511456623762*^9, 
   3.942511458798452*^9}},ExpressionUUID->"32fa2425-d9f1-4377-9c14-\
15adb6557685"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PostSqueezingdBCond", " ", "=", 
  RowBox[{"r2dB", "/.", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{
             RowBox[{"Log", "[", 
              SuperscriptBox["10", 
               RowBox[{"(", 
                FractionBox["r2dB", "10"], ")"}]], "]"}], "/", "2"}]}]], " ", 
          
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}]}], "==", 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", "r"}], "]"}]}], ",", "r2dB", ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r2dB", " ", "\[Element]", " ", "Reals"}], ",", " ", 
           RowBox[{"r1", ">", "0"}], ",", 
           RowBox[{"r", ">", "0"}]}], "}"}]}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{"r1", ">", "r"}], "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.92547354213356*^9, 3.925473547971616*^9}, {
   3.9254736007345743`*^9, 3.925473634180585*^9}, {3.925474075248296*^9, 
   3.925474078183597*^9}, {3.92547496953056*^9, 3.9254749810490637`*^9}, 
   3.925475095450697*^9, 3.925475251273325*^9, 3.9254754056579933`*^9, {
   3.926699952815115*^9, 3.926699954830386*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"3b637bdc-0f2b-4fe2-a09d-2ff793cf503f"],

Cell[BoxData[
 FractionBox[
  RowBox[{"10", " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"Cosh", "[", 
      RowBox[{"2", " ", "r1"}], "]"}], " ", 
     RowBox[{"Sech", "[", 
      RowBox[{"2", " ", "r"}], "]"}]}], "]"}]}], 
  RowBox[{"Log", "[", "10", "]"}]]], "Output",
 CellChangeTimes->{
  3.9425118170384073`*^9, 3.94275118339957*^9, 3.9427514405033712`*^9, 
   3.942751485577677*^9, 3.942751781187964*^9, {3.942751827552051*^9, 
   3.942751830909849*^9}, 3.942757414393429*^9, 3.9427594844278307`*^9, 
   3.9427597945177402`*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"5d873c30-c126-4026-82f5-8fe747f55ef8"]
}, Open  ]],

Cell["\<\
To have maximum GPS successes probability and correct GKP spacing, the post \
PNR squeezing is found by subbing in the max prob squeezing and squeezing \
that gives optimal spacing for breeding into the condition found above  \
\>", "Text",
 CellChangeTimes->{{3.923138262913795*^9, 3.923138310837008*^9}, {
   3.923139208002829*^9, 3.923139225283452*^9}, {3.92313937372439*^9, 
   3.9231394586792707`*^9}, {3.923139556613721*^9, 3.923139701274169*^9}, {
   3.923139899556759*^9, 3.923139946625246*^9}, {3.923140033144418*^9, 
   3.923140036670156*^9}, {3.923140078595244*^9, 3.923140108924652*^9}, {
   3.9231402306471*^9, 3.923140426126731*^9}, {3.923146988144936*^9, 
   3.923147047411865*^9}, {3.9233206024384613`*^9, 3.9233206207250633`*^9}, {
   3.923762545537423*^9, 3.9237626502228107`*^9}, {3.923762711739785*^9, 
   3.9237627139745493`*^9}, {3.9237642870084133`*^9, 
   3.9237642976112537`*^9}, {3.92541250679567*^9, 3.925412540290926*^9}, {
   3.92547241312761*^9, 3.925472441151011*^9}, 3.925472754166995*^9, {
   3.925473125117536*^9, 3.925473176620142*^9}, {3.925473246428997*^9, 
   3.9254733886871634`*^9}, {3.925473744070972*^9, 3.925473792737729*^9}, {
   3.925473839045796*^9, 3.925473940127165*^9}, {3.9425115348483152`*^9, 
   3.94251158196073*^9}},ExpressionUUID->"19acb1f6-a13e-472e-a092-\
c816020202ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OptSpacingPostSqueezing", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PostSqueezingdBCond", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r1", "->", 
         RowBox[{
          RowBox[{"Log", "[", 
           SuperscriptBox["10", 
            RowBox[{"(", 
             FractionBox[
              RowBox[{"MaxGPSProbSqueezingdB", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], "10"], ")"}]], "]"}], "/", 
          "2"}]}], ",", 
        RowBox[{"r", "->", 
         RowBox[{
          RowBox[{"Log", "[", 
           SuperscriptBox["10", 
            RowBox[{"(", 
             FractionBox[
              RowBox[{"OptCatStateSqueezingdB", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "2"}], "]"}], "]"}], "10"], ")"}]], "]"}], 
          "/", "2"}]}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9254740978597927`*^9, 3.925474141024015*^9}, {
  3.925474485618676*^9, 3.925474500979224*^9}, {3.925475260522891*^9, 
  3.9254752692510233`*^9}, {3.9254754101238613`*^9, 3.925475412181178*^9}, {
  3.925569435650147*^9, 3.925569445248438*^9}, {3.9258307045568933`*^9, 
  3.925830704774941*^9}, {3.9272194281460123`*^9, 3.927219460149817*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"5afea56c-5e00-4a92-a2e0-2dc4310e842c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
GPS w/ squeezing auxiliary operation symplectic diagonalization and \
Bloch-Messiah decompositions \
\>", "Section",
 CellChangeTimes->{{3.931454909789013*^9, 3.9314549125328827`*^9}, {
   3.942418126067803*^9, 3.942418130179611*^9}, {3.942418787409634*^9, 
   3.942418794835491*^9}, {3.942421598851054*^9, 3.9424216006650352`*^9}, {
   3.942422754387985*^9, 3.942422755946877*^9}, {3.942455511866585*^9, 
   3.942455516506742*^9}, 3.942510430504285*^9, {3.942755626726407*^9, 
   3.942755667779682*^9}},ExpressionUUID->"6f7a1548-1e50-4501-a22e-\
815dfaa99b62"],

Cell["\<\
First, we analytically decompose the GPS circuit with the  squeezing \
auxiliary operation such that the post GPS squeezing is moved to the \
beginning of the circuit. We will perform the symplectic diagonalization and \
Bloch-Messiah Decomposition of the Wigner function covariance matrix  \
\>", "Text",
 CellChangeTimes->{{3.942509846275928*^9, 3.942509863579225*^9}, {
   3.942509894355262*^9, 3.9425100193796873`*^9}, {3.942510071311657*^9, 
   3.9425102055286407`*^9}, {3.942510236221339*^9, 3.942510258960341*^9}, {
   3.9425118408324537`*^9, 3.942511843216535*^9}, 
   3.9427556545799017`*^9},ExpressionUUID->"aa924584-64d5-447c-ae93-\
5074d60e8308"],

Cell["Set number of modes ", "Text",
 CellChangeTimes->{{3.923138262913795*^9, 3.923138310837008*^9}, {
  3.923139208002829*^9, 3.923139225283452*^9}, {3.92313937372439*^9, 
  3.9231394586792707`*^9}, {3.923139556613721*^9, 3.923139701274169*^9}, {
  3.923139899556759*^9, 3.923139946625246*^9}, {3.923140033144418*^9, 
  3.923140036670156*^9}, {3.923140078595244*^9, 3.923140108924652*^9}, {
  3.9231402306471*^9, 3.923140426126731*^9}, {3.923146988144936*^9, 
  3.923147047411865*^9}, {3.9233206024384613`*^9, 3.9233206207250633`*^9}, {
  3.923762545537423*^9, 3.9237626502228107`*^9}, {3.923762711739785*^9, 
  3.9237627139745493`*^9}, {3.9237642870084133`*^9, 3.923764432582305*^9}, {
  3.9237644704731607`*^9, 3.9237645217290707`*^9}, {3.923764554504734*^9, 
  3.923764631896927*^9}, {3.923764836912278*^9, 3.923764888302394*^9}, {
  3.9237650269767847`*^9, 3.9237650321831903`*^9}, {3.94251208114711*^9, 
  3.942512082661573*^9}},ExpressionUUID->"a100edb8-d151-4d9d-b8c5-\
f5f7593ff439"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Modes", " ", "=", "2"}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzFtIkwEYxvERI13bBLPDtC6ULC0rNxOs1ur7JonZkqGdZm7T5TYrmiRe
OB0Um9XEWGZrpGbZErETDFakUakwJIbGKoVAIc0iXX3zgGgZRe/7Xjz8rp5/
kqGiwLiCx+NlwFBZfWN1w0qOHfgttqITtxWdqNqoJIOFac/Q1MjRl2jmkdeR
MBijGSZb700Wz4B39MukJWOXvCyKY1VzavLyrbSgERyN2kMu9qyzmkCneBup
E8tqykFlUEt6DsXFzoHJeyVk5cwxuSCaYx8mGchZgbxYBDZfUJCqkREzmueK
L0dLdidKxOAgU0AKKmpCJjAz/SI5LPx00CHk2KnDY6S0LdKEmvSzHrTnveN+
HeivqSdH+wtrm8FX5zpsaIA5+cSHf20J+UL9I/AcdNv/kYyHcXKg52kV+ZNv
Y/6CKb12si4SkkeLOLYqZpKUWfKzUeW4mSx8UJu/Cgxk2cnwest5NCJ8RNou
ufvjwIaWdtLXlhVEB3kMeW15Wr8GdC0dMKDdxZr2VDDvjI5UebrubgXVC92k
aa00aid2c1lyQKvVMiBv3EmeGPviQXU538kmXfVpFqzsspELYfNZ1Dp1leT/
mnCgUsU8+XGpU6IBk27kJqCJQxtT0OP8dDLZv1+D7ruSTb7tPVWKqq2l5J8h
kR8tc8aSizmKHnSJrySL5r++Qb0tYbJx9TdBEeh+N012fXbGo6HHrg2o78N1
Pbpj002yo9XhdYB9fi8Z2bylD92eICf/A1z5Y6k=
  "],
 CellLabel->
  "In[130]:=",ExpressionUUID->"31093a27-8ec5-4f7d-ae26-5f63779d0c49"],

Cell["Generate GPS input covariance matrix  ", "Text",
 CellChangeTimes->{{3.923138262913795*^9, 3.923138310837008*^9}, {
  3.923139208002829*^9, 3.923139225283452*^9}, {3.92313937372439*^9, 
  3.9231394586792707`*^9}, {3.923139556613721*^9, 3.923139701274169*^9}, {
  3.923139899556759*^9, 3.923139946625246*^9}, {3.923140033144418*^9, 
  3.923140036670156*^9}, {3.923140078595244*^9, 3.923140108924652*^9}, {
  3.9231402306471*^9, 3.923140426126731*^9}, {3.923146988144936*^9, 
  3.923147047411865*^9}, {3.9233206024384613`*^9, 3.9233206207250633`*^9}, {
  3.923762545537423*^9, 3.9237626502228107`*^9}, {3.923762711739785*^9, 
  3.9237627139745493`*^9}, {3.9237642870084133`*^9, 3.923764432582305*^9}, {
  3.9237644704731607`*^9, 3.9237645217290707`*^9}, {3.923764554504734*^9, 
  3.923764631896927*^9}, {3.923764836912278*^9, 3.923764888302394*^9}, {
  3.9237650269767847`*^9, 3.923765051954022*^9}, {3.942510507342894*^9, 
  3.9425105079729023`*^9}},ExpressionUUID->"adafbbc3-84a9-4f57-9b05-\
4d8a8e0b385c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"d", ",", " ", "V0"}], "}"}], " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"DisplacedSqueezedMoments", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"2", "*", "Modes"}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "r1"}], ",", "r1"}], "}"}]}], "]"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{"r1", " ", ">", " ", "0"}], "}"}]}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.923765063851418*^9, 3.923765074861876*^9}, {
  3.923765306849819*^9, 3.923765308038432*^9}, {3.925569220967676*^9, 
  3.925569224043565*^9}, {3.942512359005896*^9, 3.942512359286326*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"149d527a-1ff4-4297-bcbc-273410c3a3c9"],

Cell["Create and apply GPS beam splitter transformation ", "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQfd727q1TVm8dj5649QBE64ozBJ4G0lxCmsEg2kRv
eyqInrYntABEz1o8uQZE/zu6og9E/7hQuBxEszCFrAXRQvNVdoDo14VTwbQt
z+W9IPrAtLkHQTT31isXQLQen8tLEB24uEX2PJBm0HurAqIfsPs9VrZ+67jD
ePpTED3JyHDdbyDtoui+G0QHrfl+CEQ36dsfBtFvXB60/wHSdouEZoFoJZXz
80B0T4j5UhB9Qi1gJYhesPnPJhCdZDj3DIg2W8t5GURfcox/AqIj2+ueg+ig
dU5vwObZcr0D0aaSk77sjX/r+OLAEjANADsepCk=
  "],ExpressionUUID->"55afa87c-7ceb-4386-a20b-8495eabe1fb9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"S", " ", "=", 
   RowBox[{"BSTransform", "[", 
    RowBox[{"Modes", ",", "1", ",", "2", ",", " ", "R"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"S", ".", "V0", ".", 
      RowBox[{"Transpose", "[", "S", "]"}]}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r1", " ", "\[Element]", " ", "Reals"}], ",", " ", 
        RowBox[{"0", "<", "\[CurlyPhi]1", "<", 
         RowBox[{"2", "*", "Pi"}]}], ",", " ", 
        RowBox[{"r2", " ", "\[Element]", " ", "Reals"}], ",", "  ", 
        RowBox[{"0", "<", "\[CurlyPhi]2", "<", 
         RowBox[{"2", "*", "Pi"}]}], ",", " ", 
        RowBox[{"0", "<", "R", "<", "1"}]}], "}"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.923765114280468*^9, 3.9237651145527897`*^9}, {
  3.924985955852598*^9, 3.924985992815398*^9}, {3.94251232568712*^9, 
  3.9425123424461823`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"c900a262-b4ff-4389-96ff-30c557a26f2a"],

Cell["Find GPS beam splitter condition ", "Text",
 CellChangeTimes->{{3.923138262913795*^9, 3.923138310837008*^9}, {
   3.923139208002829*^9, 3.923139225283452*^9}, {3.92313937372439*^9, 
   3.9231394586792707`*^9}, {3.923139556613721*^9, 3.923139701274169*^9}, {
   3.923139899556759*^9, 3.923139946625246*^9}, {3.923140033144418*^9, 
   3.923140036670156*^9}, {3.923140078595244*^9, 3.923140108924652*^9}, {
   3.9231402306471*^9, 3.923140426126731*^9}, {3.923146988144936*^9, 
   3.923147047411865*^9}, {3.9233206024384613`*^9, 3.9233206207250633`*^9}, {
   3.923762545537423*^9, 3.9237626502228107`*^9}, {3.923762711739785*^9, 
   3.9237627139745493`*^9}, {3.9237642870084133`*^9, 3.923764432582305*^9}, {
   3.9237644704731607`*^9, 3.9237645217290707`*^9}, {3.923764554504734*^9, 
   3.923764631896927*^9}, {3.923764836912278*^9, 3.923764888302394*^9}, {
   3.9237650269767847`*^9, 3.923765051954022*^9}, {3.9237650900837793`*^9, 
   3.923765104319976*^9}, {3.9237651452842283`*^9, 3.923765149363676*^9}, 
   3.923765327939639*^9, {3.9425105424019938`*^9, 
   3.942510543160109*^9}},ExpressionUUID->"a8e3bcf6-2d9e-43d0-97cd-\
2952adba3402"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Con", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "r1"}]], "-", 
          RowBox[{"2", " ", "R", " ", 
           RowBox[{"Sinh", "[", 
            RowBox[{"2", " ", "r1"}], "]"}]}]}], "==", "1"}], ",", "R"}], 
       "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"r1", ">", "0"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.923750679811164*^9, 3.923750691057585*^9}, {
   3.923765157017115*^9, 3.923765173198668*^9}, 3.923765320538776*^9, {
   3.924986004265254*^9, 3.924986008233227*^9}, 3.9425123641118402`*^9},
 CellLabel->
  "In[134]:=",ExpressionUUID->"6d3f20b5-bc9a-4f11-8099-944b5c7348b3"],

Cell["Apply GPS condition ", "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQfd727q1TVm8dj5649QBE64ozBJ4G0lxCmsEg2kRv
eyqInrYntABEz1o8uQZE/zu6og9E/7hQuBxEszCFrAXRQvNVdoDo14VTwbQt
z+W9IPrAtLkHQTT31isXQLQen8tLEB24uEX2PJBm0HurAqIfsPs9VrZ+67jD
ePpTED3JyHDdbyDtoui+G0QHrfl+CEQ36dsfBtFvXB60/wHSdouEZoFoJZXz
80B0T4j5UhB9Qi1gJYhesPnPJhCdZDj3DIg2W8t5GURfcox/AqIj2+ueg+ig
dU5vwObZcr0D0WkSmp9BtM3i1WC6TfAf518gvcrlKBeIBgCwqKuK
  "],ExpressionUUID->"94510c21-564e-43fc-95de-959fa91fe74b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"V", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"V", "/.", "Con"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"r1", ">", "0"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9237653392215014`*^9, 3.9237653570010977`*^9}, 
   3.923765512387422*^9, {3.942512369186945*^9, 3.942512370357317*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"9c28f0b2-ad29-44e3-af9b-04a726069b9b"],

Cell["Apply squeezing auxiliary operation ", "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQfd727q1TVm8dj5649QBE64ozBJ4G0lxCmsEg2kRv
eyqInrYntABEz1o8uQZE/zu6og9E/7hQuBxEszCFrAXRQvNVdoDo14VTwbQt
z+W9IPrAtLkHQTT31isXQLQen8tLEB24uEX2PJBm0HurAqIfsPs9VrZ+67jD
ePpTED3JyHDdbyDtoui+G0QHrfl+CEQ36dsfBtFvXB60/wHSdouEZoFoJZXz
80B0T4j5UhB9Qi1gJYhesPnPJhCdZDj3DIg2W8t5GURfcox/AqIj2+ueg+ig
dU5vwObZcr0D0WkSmp9BtM3i1WC6TfAf518gvcrlKBeIvpqVzg+ig5qzBUD0
466da0wT3jq6tX4C0wA05Lwe
  "],ExpressionUUID->"645717a8-a5a8-4a26-8865-878b85e8ac53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"V", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Exp", "[", "r2", "]"}], ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", "r2"}], "]"}]}], "}"}]}], "}"}], ".", "V", ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Exp", "[", "r2", "]"}], ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", "r2"}], "]"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r1", ">", "0"}], ",", 
        RowBox[{"r2", ">", "0"}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9237654043097878`*^9, 3.9237654448960543`*^9}, {
   3.923765495013747*^9, 3.923765536356181*^9}, {3.923765680853835*^9, 
   3.923765683175777*^9}, {3.9237669323050833`*^9, 3.923766938470172*^9}, {
   3.923767345794548*^9, 3.923767350625936*^9}, {3.923849481467701*^9, 
   3.9238494845287848`*^9}, {3.923849620621983*^9, 3.923849671386429*^9}, {
   3.923849894822956*^9, 3.923849907975062*^9}, {3.924959639792605*^9, 
   3.924959645953946*^9}, {3.924959997350216*^9, 3.924960003602231*^9}, {
   3.9249823681685247`*^9, 3.9249823745141573`*^9}, {3.9249824358506536`*^9, 
   3.924982440767173*^9}, {3.924982722828642*^9, 3.92498272970887*^9}, {
   3.924984462638685*^9, 3.92498446808071*^9}, 3.94251229799966*^9, 
   3.942512353617909*^9},
 CellLabel->
  "In[136]:=",ExpressionUUID->"1116eb96-15b6-49eb-b6b2-ece5abc8b0af"],

Cell["Performing symplectic diagonalization  ", "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQfd727q1TVm8dj5649QBE64ozBJ4G0lxCmsEg2kRv
eyqInrYntABEz1o8uQZE/zu6og9E/7hQuBxEszCFrAXRQvNVdoDo14VTwbQt
z+W9IPrAtLkHQTT31isXQLQen8tLEB24uEX2PJBm0HurAqIfsPs9VrZ+67jD
ePpTED3JyHDdbyDtoui+G0QHrfl+CEQ36dsfBtFvXB60/wHSdouEZoFoJZXz
80B0T4j5UhB9Qi1gJYhesPnPJhCdZDj3DIg2W8t5GURfcox/AqIj2+ueg+ig
dU5vwObZcr0D0WkSmp9BtM3i1WC6TfAf518gvcrlKBeIvpqVzg+ig5qzBUD0
CWlTURe7t47tv80lQXRDszOfK5BW2ryfH0QDAOzjwBY=
  "],ExpressionUUID->"8f47a48e-1df7-4cda-a998-ac0e7f8aa15e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalOmega]", " ", "=", " ", 
   RowBox[{"OmegaCreate", "[", "Modes", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Db", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{
      RowBox[{"1", "/", "2"}], ",", 
      RowBox[{"2", "*", "Modes"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.924961429360118*^9, 3.924961429591444*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"770e2ed9-b233-4aa1-9c06-478020ce6f9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VInv", " ", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"4", "*", 
      RowBox[{"(", 
       RowBox[{"\[CapitalOmega]", ".", "V", ".", 
        RowBox[{"Transpose", "[", "\[CapitalOmega]", "]"}]}], ")"}]}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r1", ">", "0"}], ",", 
        RowBox[{"r2", ">", "0"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"VInv", "-", 
       RowBox[{"Inverse", "[", "V", "]"}]}], ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r1", ">", "0"}], ",", 
         RowBox[{"r2", ">", "0"}]}], "}"}]}]}], "]"}], "==", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.92496195569958*^9, {3.9249619867350197`*^9, 3.92496199750469*^9}, {
   3.924962041028084*^9, 3.924962069192005*^9}, 3.924962206727158*^9, {
   3.942511895282992*^9, 3.9425119252080193`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"e933962d-a3c4-470c-8dfc-8d99cad0414d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Mm12", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r1", ">", "0"}], ",", 
         RowBox[{"r2", ">", "0"}]}], "}"}], ",", 
       RowBox[{"MatrixPower", "[", 
        RowBox[{"VInv", ",", 
         RowBox[{"1", "/", "2"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r1", ">", "0"}], ",", 
        RowBox[{"r2", ">", "0"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SPrime", " ", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"\[CapitalOmega]", ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Mm12", ".", 
        RowBox[{"MatrixPower", "[", 
         RowBox[{"Db", ",", 
          RowBox[{"1", "/", "2"}]}], "]"}]}], "]"}], ".", 
      RowBox[{"Transpose", "[", "\[CapitalOmega]", "]"}]}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r1", ">", "0"}], ",", 
        RowBox[{"r2", ">", "0"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SymplecticQ", " ", "=", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"SPrime", ".", "\[CapitalOmega]", ".", 
       RowBox[{"Transpose", "[", "SPrime", "]"}]}], ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r1", ">", "0"}], ",", 
         RowBox[{"r2", ">", "0"}]}], "}"}]}]}], "]"}], " ", "==", 
    "\[CapitalOmega]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Check", " ", "that", " ", "SPrime", " ", "is", " ", "a", " ", 
    "symplectic", " ", "matrix"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"SPrime", ".", "Db", ".", 
        RowBox[{"Transpose", "[", "SPrime", "]"}]}], ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"r1", ">", "0"}], ",", 
          RowBox[{"r2", ">", "0"}]}], "}"}]}]}], "]"}], "-", "V"}], ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r1", ">", "0"}], ",", 
       RowBox[{"r2", ">", "0"}]}], "}"}]}]}], "]"}], "==", " ", 
  RowBox[{"ConstantArray", "[", 
   RowBox[{"0", ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "4"}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Check", " ", "that", " ", "application", " ", "of", " ", "SPrime", " ", 
     "to", " ", "vacuum", " ", "covariance", " ", "matrix", " ", "recovers", 
     " ", "the", " ", "origonal", " ", "final", " ", "covariance", " ", 
     "matrix"}], ",", " ", "V"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.898700694972204*^9, 3.898700754762391*^9}, {
   3.8987008328033953`*^9, 3.898700860488051*^9}, {3.8987022401420927`*^9, 
   3.898702246887166*^9}, 3.898740045964301*^9, {3.898740164007366*^9, 
   3.8987401646686296`*^9}, {3.898790752859653*^9, 3.898790767187953*^9}, {
   3.8987913252214947`*^9, 3.898791345080271*^9}, {3.89879257117656*^9, 
   3.898792588863799*^9}, {3.898793026573833*^9, 3.898793029846437*^9}, 
   3.898793171451357*^9, 3.898793985971415*^9, 3.898794187003953*^9, 
   3.898794268379591*^9, {3.898794322049901*^9, 3.898794322646446*^9}, {
   3.898794428145047*^9, 3.898794429133573*^9}, 3.898794774158915*^9, {
   3.898794963159418*^9, 3.898794963905788*^9}, {3.8987950674769297`*^9, 
   3.898795072631543*^9}, {3.89879527957979*^9, 3.8987952854578876`*^9}, {
   3.898795482756055*^9, 3.898795511827057*^9}, {3.89879559208812*^9, 
   3.8987955958382072`*^9}, {3.8987959427703648`*^9, 3.8987959476700563`*^9}, 
   3.923750253266321*^9, {3.9237505869015636`*^9, 3.9237506473626633`*^9}, {
   3.9237507509254723`*^9, 3.923750756897913*^9}, {3.923765739462687*^9, 
   3.9237657433599443`*^9}, {3.9249620856760073`*^9, 3.924962213316543*^9}, {
   3.924986642504705*^9, 3.9249866517454023`*^9}, {3.942510841965437*^9, 
   3.942510842924624*^9}, {3.942750644988125*^9, 
   3.942750739034409*^9}},ExpressionUUID->"30ef33a2-6119-4da2-a093-\
76fb4be707d2"],

Cell["\<\
Getting the symplectic transformation to perform on vacuum for every n with \
appropriate r1 and r2 for max fidelity and probability \
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQfd727q1TVm8dj5649QBE64ozBJ4G0lxCmsEg2kRv
eyqInrYntABEz1o8uQZE/zu6og9E/7hQuBxEszCFrAXRQvNVdoDo14VTwbQt
z+W9IPrAtLkHQTT31isXQLQen8tLEB24uEX2PJBm0HurAqIfsPs9VrZ+67jD
ePpTED3JyHDdbyDtoui+G0QHrfl+CEQ36dsfBtFvXB60/wHSdouEZoFoJZXz
80B0T4j5UhB9Qi1gJYhesPnPJhCdZDj3DIg2W8t5GURfcox/AqIj2+ueg+ig
dU5vwObZcr0D0WkSmp9BtM3i1WC6TfAf518gvcrlKBeIvpqVzg+ig5qzBUD0
CWlTURe7t47tv80lQfSBmpByVyB9ysyqEkQLhzi6Gie8dbx8Z6obiAYAPBrH
0w==
  "],ExpressionUUID->"7f4594a6-ce95-4e2b-9fa4-0318964b80da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", "\"\<Bloch Messiah Decompositions/SPrime\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9252153903190193`*^9, 3.925215393733108*^9}, 
   3.9425108274579487`*^9, {3.9425111132274218`*^9, 3.9425111398275967`*^9}, {
   3.942511699190404*^9, 3.942511701557695*^9}, {3.942761086106895*^9, 
   3.9427611349153957`*^9}, {3.942761171695381*^9, 3.94276120667489*^9}, {
   3.942761938307514*^9, 3.9427619596658173`*^9}, {3.9427626343587227`*^9, 
   3.942762635676828*^9}},ExpressionUUID->"69e803c2-ca11-4809-a87e-\
c5cb650ad803"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OptSPrimeTable", " ", "=", " ", 
   RowBox[{"N", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SPrime", " ", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r1", "->", 
          RowBox[{
           RowBox[{"Log", "[", 
            SuperscriptBox["10", 
             RowBox[{"(", 
              FractionBox[
               RowBox[{"MaxGPSProbSqueezingdB", "[", 
                RowBox[{"[", "ii", "]"}], "]"}], "10"], ")"}]], "]"}], "/", 
           "2"}]}], ",", 
         RowBox[{"r2", "->", 
          RowBox[{
           RowBox[{"Log", "[", 
            SuperscriptBox["10", 
             RowBox[{"(", 
              FractionBox[
               RowBox[{"OptSpacingPostSqueezing", "[", 
                RowBox[{"[", "ii", "]"}], "]"}], "10"], ")"}]], "]"}], "/", 
           "2"}]}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9249594411613903`*^9, 3.9249594815825*^9}, {
   3.924959519388606*^9, 3.924959521152659*^9}, {3.924959565634853*^9, 
   3.924959674101294*^9}, 3.924961408514859*^9, {3.924962258371415*^9, 
   3.924962261060479*^9}, {3.9249862246878643`*^9, 3.924986226530854*^9}, {
   3.924987087944786*^9, 3.9249870910048532`*^9}, {3.9255694977370033`*^9, 
   3.925569508071509*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"4006aa70-0198-4ac4-8fa5-33839c25b208"],

Cell["Performing Bloch-Messiah Decomposition numerically   ", "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQfd727q1TVm8dj5649QBE64ozBJ4G0lxCmsEg2kRv
eyqInrYntABEz1o8uQZE/zu6og9E/7hQuBxEszCFrAXRQvNVdoDo14VTwbQt
z+W9IPrAtLkHQTT31isXQLQen8tLEB24uEX2PJBm0HurAqIfsPs9VrZ+67jD
ePpTED3JyHDdbyDtoui+G0QHrfl+CEQ36dsfBtFvXB60/wHSdouEZoFoJZXz
80B0T4j5UhB9Qi1gJYhesPnPJhCdZDj3DIg2W8t5GURfcox/AqIj2+ueg+ig
dU5vwObZcr0D0WkSmp9BtM3i1WC6TfAf518gvcrlKBeIvpqVzg+ig5qzBUD0
CWlTURe7t47tv80lQXRDszOfK5BW2ryfH0QbNb9vANHPVmc3g+iAaZnuxglv
He8wrQfTAPLlzwk=
  "],ExpressionUUID->"ffe7d859-3a57-4f27-adb3-857a754d6d49"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SVDTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SingularValueDecomposition", "[", 
      RowBox[{"OptSPrimeTable", "[", 
       RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SqueezingTransformationTable", " ", "=", " ", 
   RowBox[{"SVDTable", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PassiveTransformationTable", " ", "=", " ", 
   RowBox[{"SVDTable", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"PassiveUnitaryTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PassiveTransformationTable", "[", 
       RowBox[{"[", 
        RowBox[{"ii", ",", 
         RowBox[{"1", ";;", "2"}], ",", 
         RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "+", 
      RowBox[{"I", "*", 
       RowBox[{"PassiveTransformationTable", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", 
          RowBox[{"3", ";;", "4"}], ",", 
          RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"UnitaryTest", " ", "=", " ", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{"Boole", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"UnitaryMatrixQ", "[", 
        RowBox[{"PassiveUnitaryTable", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", " ", 
         RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}], "]"}], 
    "]"}], "==", 
   RowBox[{"Length", "[", "nSpace", "]"}], 
   RowBox[{"(*", 
    RowBox[{
    "Check", " ", "that", " ", "decompostion", " ", "resulted", " ", "in", 
     " ", "unitary", " ", "matrices"}], "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.923849099356821*^9, 3.923849144195628*^9}, {
   3.9238518856061907`*^9, 3.9238519023547792`*^9}, {3.924007937961995*^9, 
   3.924007940917104*^9}, {3.924962389725711*^9, 3.92496242237158*^9}, {
   3.9249624725296717`*^9, 3.9249625102798653`*^9}, {3.924962553528241*^9, 
   3.924962665621153*^9}, {3.924973207941299*^9, 3.924973380065743*^9}, 
   3.925569532369278*^9, {3.942750811138214*^9, 3.942750825535276*^9}, 
   3.942755269712407*^9},
 CellLabel->
  "In[142]:=",ExpressionUUID->"0d9a619b-400b-4e25-8f4a-3a23cb7d69c8"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.924973321837343*^9, {3.924973360629754*^9, 3.9249733844691896`*^9}, 
   3.9249823866125298`*^9, 3.924982495087412*^9, 3.924982739329316*^9, 
   3.92498447656924*^9, 3.92498586964128*^9, 3.924986052192871*^9, 
   3.924986229881742*^9, {3.9249870851806707`*^9, 3.924987094034766*^9}, 
   3.924989005564501*^9, 3.9249895920486593`*^9, 3.9252156427988358`*^9, 
   3.925569529109421*^9, 3.926003855526771*^9, {3.9260958504572372`*^9, 
   3.926095865257704*^9}, 3.9261844519517527`*^9, 3.926186891601081*^9, 
   3.926189081271997*^9, 3.9264395590013723`*^9, 3.9265075468328876`*^9, 
   3.942751215646326*^9, 3.9427514607243137`*^9, 3.942751502499548*^9, 
   3.942751800427504*^9, 3.942751840807049*^9, 3.9427574397703257`*^9, 
   3.942759505085058*^9, 3.942759810367566*^9},
 CellLabel->
  "Out[146]=",ExpressionUUID->"86a6cf65-58f6-4b16-a868-9366cb5a616c"]
}, Open  ]],

Cell["\<\
Extracting squeezing, transmissivities, and phases from unitary matrices    \
\>", "Text",
 CellChangeTimes->{{3.923138262913795*^9, 3.923138310837008*^9}, {
   3.923139208002829*^9, 3.923139225283452*^9}, {3.92313937372439*^9, 
   3.9231394586792707`*^9}, {3.923139556613721*^9, 3.923139701274169*^9}, {
   3.923139899556759*^9, 3.923139946625246*^9}, {3.923140033144418*^9, 
   3.923140036670156*^9}, {3.923140078595244*^9, 3.923140108924652*^9}, {
   3.9231402306471*^9, 3.923140426126731*^9}, {3.923146988144936*^9, 
   3.923147047411865*^9}, {3.9233206024384613`*^9, 3.9233206207250633`*^9}, {
   3.923762545537423*^9, 3.9237626502228107`*^9}, {3.923762711739785*^9, 
   3.9237627139745493`*^9}, {3.9237642870084133`*^9, 3.923764432582305*^9}, {
   3.9237644704731607`*^9, 3.9237645217290707`*^9}, {3.923764554504734*^9, 
   3.923764631896927*^9}, {3.923764836912278*^9, 3.923764888302394*^9}, {
   3.9237650269767847`*^9, 3.923765051954022*^9}, {3.9237650900837793`*^9, 
   3.923765104319976*^9}, {3.9237651452842283`*^9, 3.923765149363676*^9}, {
   3.923765327939639*^9, 3.923765334164632*^9}, {3.923765371231791*^9, 
   3.9237653793597803`*^9}, {3.9249594016596413`*^9, 3.924959433749454*^9}, {
   3.9249613941098022`*^9, 3.924961405990617*^9}, {3.924962311484765*^9, 
   3.9249623313647337`*^9}, {3.9427507792995987`*^9, 3.942750781469099*^9}, {
   3.942750860062933*^9, 3.9427508959151373`*^9}, 
   3.942755266762167*^9},ExpressionUUID->"a96dc72c-30ec-47ff-9fb3-\
48354bde89f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SqueezingValuesTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"y", "/.", 
        RowBox[{
         RowBox[{"Quiet", "[", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Log", "[", 
                SuperscriptBox["10", 
                 RowBox[{"(", 
                  FractionBox["y", "10"], ")"}]], "]"}], "/", "2"}], " ", "==",
               "x"}], "/.", 
             RowBox[{
              RowBox[{"NSolve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", "x", "]"}], "==", 
                 RowBox[{"SqueezingTransformationTable", "[", 
                  RowBox[{"[", 
                   RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", 
                "x"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "y"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"y", "/.", 
        RowBox[{
         RowBox[{"Quiet", "[", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Log", "[", 
                SuperscriptBox["10", 
                 RowBox[{"(", 
                  FractionBox["y", "10"], ")"}]], "]"}], "/", "2"}], " ", "==",
               "x"}], "/.", 
             RowBox[{
              RowBox[{"NSolve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", "x", "]"}], "==", 
                 RowBox[{"SqueezingTransformationTable", "[", 
                  RowBox[{"[", 
                   RowBox[{"ii", ",", "2", ",", "2"}], "]"}], "]"}]}], ",", 
                "x"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "y"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BSandPSTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"UnitaryDecomp", "[", 
      RowBox[{"PassiveUnitaryTable", "[", 
       RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9249733747126617`*^9, 3.9249733749677753`*^9}, {
  3.924974760271686*^9, 3.924974767140195*^9}, {3.925215034511857*^9, 
  3.925215052905469*^9}, {3.94275091347931*^9, 3.942750918056099*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"c3a2e477-be51-4536-9fa1-633e4080f3cb"],

Cell["\<\
With the new input squeezing values, beam, splitters, and phase shifters we \
check that we get the correct covariance matrix    \
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJwdzE8oQwEAx/HXUmuPNluJkcNmqR2MjVlh0+OhHGQzBydajbLELk7SMllJ
DmRqNWTJn9kOlkzIv1YLtWWUVmrlX7LHgUKb5f12+Pa5fSWmYYOZQxBEMRuM
aO/jF3UMFQrHE7CikNBfspIieResUeyZofOwewS6PPNjMBPamIU/Ues6zOEY
fVC0LAvCN+tCVm1e7AieON2nMHf3JgoVfPoV6j2TpRFWQsHIYILb8VBWz1DB
6sUnOKdS+lOstKTtABq2v8/gRGXjOUzSCUeaVbcqckGpLLIEZ4yaNRgu79yE
K4H0DjQp3Vew1seLwWuq9xH2OMZfoMHflMz+tOQ77C+Sf8IGjzfrlDDD+2Pd
okMkvB0cEECD3ZIPwyXqAlrHUI6URgxt9mZ+C6s0cCyAKvuHDT57LXYo9nG/
2lmnq0Z/Idk65Ff3MdSdcD/rPyb+1rU=
  "],ExpressionUUID->"fc0e03a7-8fbc-4085-8445-6a4082325a20"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"W", " ", "=", " ", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Sqrt", "[", "2", "]"}]], 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "I"}], "*", 
          RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
         RowBox[{"I", "*", 
          RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}], "}"}]}], "}"}], 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DecompCheckUnitaryTable", " ", "=", " ", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "2", "]"}], ".", 
         RowBox[{"TCreate", "[", 
          RowBox[{"2", ",", "1", ",", "2"}], "]"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"phi", "->", 
           RowBox[{"BSandPSTable", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "1"}], "]"}], "]"}]}], ",", 
          RowBox[{"theta", "->", 
           RowBox[{"BSandPSTable", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], " ", ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}], "//", 
     "Chop"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Assemble", " ", "passive", " ", "unitary", " ", "from", " ", "beam", " ", 
    "splitter", " ", "and", " ", "phase", " ", "values"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DecompCheckPassiveSymplecticTable", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"W", ".", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DecompCheckUnitaryTable", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
            RowBox[{"Conjugate", "[", 
             RowBox[{"DecompCheckUnitaryTable", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], "]"}],
        ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Conjugate", "[", "W", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Convert", " ", "passive", " ", "unitary", " ", "to", " ", "symplectic", 
    " ", "transformation", " ", "to", " ", "apply", " ", "to", " ", 
    "covariance", " ", "matrix"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DecompCheckActiveSymplecticTable", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Log", "[", 
              SuperscriptBox["10", 
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"SqueezingValuesTable", "[", 
                  RowBox[{"[", 
                   RowBox[{"ii", ",", "1"}], "]"}], "]"}], "10"], ")"}]], 
              "]"}], "/", "2"}], ")"}]}], "]"}], ",", 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Log", "[", 
              SuperscriptBox["10", 
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"SqueezingValuesTable", "[", 
                  RowBox[{"[", 
                   RowBox[{"ii", ",", "2"}], "]"}], "]"}], "10"], ")"}]], 
              "]"}], "/", "2"}], ")"}]}], "]"}], ",", 
         RowBox[{"Exp", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Log", "[", 
             SuperscriptBox["10", 
              RowBox[{"(", 
               FractionBox[
                RowBox[{"SqueezingValuesTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"ii", ",", "1"}], "]"}], "]"}], "10"], ")"}]], 
             "]"}], "/", "2"}], ")"}], "]"}], ",", 
         RowBox[{"Exp", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Log", "[", 
             SuperscriptBox["10", 
              RowBox[{"(", 
               FractionBox[
                RowBox[{"SqueezingValuesTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"ii", ",", "2"}], "]"}], "]"}], "10"], ")"}]], 
             "]"}], "/", "2"}], ")"}], "]"}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Assemble", " ", "active", " ", "squeezing", " ", "symplectic", " ", 
    "tranformation"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DecompCheckTotalSymplecticTable", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DecompCheckPassiveSymplecticTable", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ".", 
       RowBox[{"DecompCheckActiveSymplecticTable", "[", 
        RowBox[{"[", "ii", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Assemble", " ", "total", " ", "symplectic", " ", "tranformation"}], ",", 
    " ", 
    RowBox[{
    "squeezing", " ", "then", " ", "passive", " ", "transformation"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DecompCheckCovarianceMatrixTable", " ", "=", " ", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DecompCheckTotalSymplecticTable", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], ".", "Db", ".", 
        RowBox[{"Transpose", "[", 
         RowBox[{"DecompCheckTotalSymplecticTable", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}], "//", 
     "Chop"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Apply", " ", "total", " ", "symplectic", " ", "tranformation", " ", "to", 
    " ", "vacuum"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DecompCheckVTable", " ", "=", " ", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"V", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r1", "->", 
           RowBox[{
            RowBox[{"Log", "[", 
             SuperscriptBox["10", 
              RowBox[{"(", 
               FractionBox[
                RowBox[{"MaxGPSProbSqueezingdB", "[", 
                 RowBox[{"[", "ii", "]"}], "]"}], "10"], ")"}]], "]"}], "/", 
            "2"}]}], ",", 
          RowBox[{"r2", "->", 
           RowBox[{
            RowBox[{"Log", "[", 
             SuperscriptBox["10", 
              RowBox[{"(", 
               FractionBox[
                RowBox[{"OptSpacingPostSqueezing", "[", 
                 RowBox[{"[", "ii", "]"}], "]"}], "10"], ")"}]], "]"}], "/", 
            "2"}]}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}], "//", 
     "Chop"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Substitute", " ", "numerical", " ", "values", " ", "into", " ", 
    "origonal", " ", "final", " ", "covaraince", " ", "matrix", " ", "to", 
    " ", "compare", " ", "to"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"DecompCheck", " ", "=", " ", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{"Boole", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"DecompCheckVTable", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "-", 
          RowBox[{"DecompCheckCovarianceMatrixTable", "[", 
           RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "==", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.", ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}], "]"}], 
    "]"}], "==", 
   RowBox[{"Length", "[", "nSpace", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.924973840502877*^9, 3.9249738490378304`*^9}, 
   3.924973886026382*^9, {3.924973929961294*^9, 3.9249739771217403`*^9}, 
   3.925215026811924*^9, {3.9252156526703587`*^9, 3.925215653104147*^9}, {
   3.9255695631686783`*^9, 3.9255695688229427`*^9}, {3.926010490319272*^9, 
   3.926010497832879*^9}, {3.926439580260972*^9, 3.926439591053566*^9}, {
   3.942750978000965*^9, 3.9427509782926807`*^9}, 3.942751368661826*^9, {
   3.942755296157645*^9, 3.942755505045632*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"237bba53-75eb-4381-a073-d18490eb4922"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.925215647809493*^9, 3.925215654585574*^9}, 
   3.925569572144883*^9, 3.926003863220264*^9, 3.926010498485283*^9, 
   3.9260958677596073`*^9, 3.92618493752179*^9, 3.926187033362277*^9, 
   3.926439593750635*^9, 3.926507556132794*^9, 3.9427512243766527`*^9, 
   3.9427514640824347`*^9, 3.9427515060282803`*^9, 3.9427518048426123`*^9, 
   3.942751843581924*^9, 3.9427574441480713`*^9, 3.94275950828614*^9, 
   3.942759814945928*^9},
 CellLabel->
  "Out[156]=",ExpressionUUID->"ad168bf7-ed66-445f-a6ec-6fe161676879"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
GPS breeding w/ damping auxiliary operation damping symplectic \
diagonalization and Bloch-Messiah decompositions\
\>", "Section",
 CellChangeTimes->{{3.931454909789013*^9, 3.9314549125328827`*^9}, {
   3.942418126067803*^9, 3.942418130179611*^9}, {3.942418787409634*^9, 
   3.942418794835491*^9}, {3.942421598851054*^9, 3.9424216006650352`*^9}, {
   3.942422754387985*^9, 3.942422755946877*^9}, {3.942455511866585*^9, 
   3.942455516506742*^9}, 3.942510430504285*^9, {3.942755626726407*^9, 
   3.942755667779682*^9}, 
   3.942757281335228*^9},ExpressionUUID->"010ee68e-0776-47b0-8af7-\
33f8d637fed0"],

Cell["\<\
Now that we have decomposed the GPS circuit w/ squeezing auxiliary operation, \
so that is it is squeezed vacuum states followed by beam splitters and PNR \
detection, we can now apply the Gaussian circuit that does the breeding step \
and damping (when applicable).  We then perform symplectic diagonalization \
and Bloch-Messiah decomposition such that  the inline squeezing that occurs \
in the QND interaction of the damping operation is moved to the beginning of \
the circuit.\
\>", "Text",
 CellChangeTimes->{{3.923138262913795*^9, 3.923138310837008*^9}, {
   3.923139208002829*^9, 3.923139225283452*^9}, {3.92313937372439*^9, 
   3.9231394586792707`*^9}, {3.923139556613721*^9, 3.923139701274169*^9}, {
   3.923139899556759*^9, 3.923139946625246*^9}, {3.923140033144418*^9, 
   3.923140036670156*^9}, {3.923140078595244*^9, 3.923140108924652*^9}, {
   3.9231402306471*^9, 3.923140426126731*^9}, {3.923146988144936*^9, 
   3.923147047411865*^9}, {3.9233206024384613`*^9, 3.9233206207250633`*^9}, {
   3.923762545537423*^9, 3.9237626502228107`*^9}, {3.923762711739785*^9, 
   3.9237627139745493`*^9}, {3.9237642870084133`*^9, 3.923764432582305*^9}, {
   3.9237644704731607`*^9, 3.9237645217290707`*^9}, 3.924959040144245*^9, {
   3.9260040828815117`*^9, 3.92600415945427*^9}, {3.9427557922507153`*^9, 
   3.942755892812338*^9}, {3.9427567173948402`*^9, 3.942756720875742*^9}, 
   3.942757031678713*^9},ExpressionUUID->"64a8f4f8-56c5-47fb-a358-\
558d27cc0f6e"],

Cell["\<\
To begin, we get two copies of the decomposed GPS circuit w/ squeezing \
auxiliary operation covariance matrices and compose them to make a 4 mode \
covariance matrix +1 more mode for damping operation.\
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQfd727q1TVm8dj5649QBE64ozBJ4G0lxCmsEg2kRv
eyqInrYntABEz1o8uQZE/zu6og9E/7hQuBxEszCFrAXRQvNVdoDo14VTwbQt
z+W9IPrAtLkHQTT31isXQLQen8tLEB24uEX2PJBm0HurAqIfsPs9VrZ+67jD
ePpTED3JyHDdbyDtoui+G0QHrfl+CEQ36dsfBtFvXB60/wHSdouEZoFoJZXz
80B0T4j5UhB9Qi1gJYhesPnPJhCdZDj3DIg2W8t5GURfcox/AqI33WF9CqJL
T6c6ujq8dfxVd8UVRFtfmRIMoi8cZooA0Wdei580TXjrWLQi4hSIXvPJz9AM
SOv/qjUB0Q5Nr0JB9Ifu0DAQDQDE9bj5
  "],ExpressionUUID->"96bf995c-036e-4965-9122-a625502073e3"],

Cell["Set number of modes  ", "Text",
 CellChangeTimes->{{3.923138262913795*^9, 3.923138310837008*^9}, {
  3.923139208002829*^9, 3.923139225283452*^9}, {3.92313937372439*^9, 
  3.9231394586792707`*^9}, {3.923139556613721*^9, 3.923139701274169*^9}, {
  3.923139899556759*^9, 3.923139946625246*^9}, {3.923140033144418*^9, 
  3.923140036670156*^9}, {3.923140078595244*^9, 3.923140108924652*^9}, {
  3.9231402306471*^9, 3.923140426126731*^9}, {3.923146988144936*^9, 
  3.923147047411865*^9}, {3.9233206024384613`*^9, 3.9233206207250633`*^9}, {
  3.923762545537423*^9, 3.9237626502228107`*^9}, {3.923762711739785*^9, 
  3.9237627139745493`*^9}, {3.9237642870084133`*^9, 3.923764432582305*^9}, {
  3.9237644704731607`*^9, 3.9237645217290707`*^9}, {3.923764554504734*^9, 
  3.923764631896927*^9}, {3.923764836912278*^9, 3.923764888302394*^9}, {
  3.9237650269767847`*^9, 
  3.9237650321831903`*^9}},ExpressionUUID->"afb66459-6e2a-4784-8415-\
400af7af1dae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Modes", " ", "=", "5"}], ";"}]], "Input",
 CellChangeTimes->{{3.895745476516747*^9, 3.89574548043674*^9}, {
   3.895745841924912*^9, 3.8957458420748672`*^9}, {3.895745953353978*^9, 
   3.895746002654072*^9}, {3.895940981915674*^9, 3.895940982635871*^9}, {
   3.895950055113233*^9, 3.895950055824171*^9}, {3.896189401599906*^9, 
   3.896189402529455*^9}, {3.896192593362002*^9, 3.896192593782209*^9}, {
   3.8961939927102003`*^9, 3.896193993314152*^9}, {3.8961980975328817`*^9, 
   3.8961980989309397`*^9}, {3.8964778326027327`*^9, 
   3.8964778327570972`*^9}, {3.896527322685479*^9, 3.896527323066609*^9}, {
   3.896533729844963*^9, 3.896533729920117*^9}, {3.896533822682287*^9, 
   3.8965338247986193`*^9}, {3.8965352330068817`*^9, 3.89653523457041*^9}, {
   3.896718979826054*^9, 3.896718979974512*^9}, {3.898350126751444*^9, 
   3.898350126884266*^9}, {3.898350743456688*^9, 3.8983507755116453`*^9}, {
   3.898352908119351*^9, 3.898352908296228*^9}, {3.898395610617414*^9, 
   3.898395621138151*^9}, {3.898443106757906*^9, 3.898443107011463*^9}, {
   3.898453543353603*^9, 3.8984535439534397`*^9}, {3.898567746018341*^9, 
   3.8985677476461897`*^9}, {3.898599939875601*^9, 3.898599940085834*^9}, {
   3.8986224305291157`*^9, 3.8986224310955143`*^9}, {3.898622490450951*^9, 
   3.898622491246125*^9}, {3.898626675863687*^9, 3.8986266760693073`*^9}, {
   3.898626923440419*^9, 3.8986269253139563`*^9}, {3.898646028640684*^9, 
   3.898646029018865*^9}, {3.898646097737999*^9, 3.8986460980000973`*^9}, {
   3.8986472953118343`*^9, 3.898647313998969*^9}, {3.898688770792568*^9, 
   3.8986887709503527`*^9}, {3.898690805268347*^9, 3.8986908057798233`*^9}, {
   3.898699833502612*^9, 3.898699834040098*^9}, {3.898737386917697*^9, 
   3.8987373882773438`*^9}, {3.898737847089397*^9, 3.8987378472273397`*^9}, {
   3.898739483761544*^9, 3.898739483895562*^9}, {3.898739539247431*^9, 
   3.898739540247128*^9}, {3.8987397430615253`*^9, 3.898739743569969*^9}, {
   3.898788037217752*^9, 3.898788050267716*^9}, {3.8987881529000397`*^9, 
   3.8987881534692793`*^9}, {3.8987885539593678`*^9, 3.898788554110136*^9}, {
   3.898788618867161*^9, 3.8987886190460587`*^9}, {3.898789272400144*^9, 
   3.8987892725478992`*^9}, {3.898789321914912*^9, 3.898789322063106*^9}, {
   3.898789367154584*^9, 3.898789367331376*^9}, {3.898789967158516*^9, 
   3.898789967306467*^9}, {3.898790092277302*^9, 3.898790108458473*^9}, {
   3.8987906524944687`*^9, 3.898790652598044*^9}, {3.898875156112749*^9, 
   3.898875157084442*^9}, {3.89887539319213*^9, 3.898875393846945*^9}, {
   3.926004825422387*^9, 3.92600482558173*^9}, {3.926005772492882*^9, 
   3.926005772682523*^9}, 3.9260058329851503`*^9, 3.9260058636899977`*^9, {
   3.92601041747799*^9, 3.926010417640579*^9}, {3.926010520915965*^9, 
   3.926010521109645*^9}, {3.926091070149444*^9, 3.926091070764945*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"3360d7b9-95b3-49bd-9ef0-2c3bcc8cbf49"],

Cell["\<\
Retrieve the subset of nSpace where damping provides fidelity improvement and \
the optimal squeezing to use for damping (DampingSqdBTable) in each case\
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJwdzFtIU3EAx/GTKLIZmw4jL/TgGqKBa16mNJ169JSQIW0uJIyUlbf5MPeQ
+CAyXDSIGjLRwJpFh6FtbQ9JJOhIi+GoZKJbDC848BLSTkJFmpvi/7eHH5+H
H3xztHp1WwJFURIy6FdurH5RcLTXtxqGBecp1VciX5TfCEukH9rg6OytHjjG
DvfDE++kBR4uGSZgYoLGBUUvJdPwp2EkrvLsigfOjdrmYcr7wBKUCpg9qGIf
XvATKSkngeHkhq2L5Rw9XfxsB1qLCt1RIpNTNwPVbw8+wcHLVZ9hhAmbY8TK
16IxKJb4x+ETTZkd+nJvvoGvpmLvoLbQ9g2WungrcJlu2Ya3zQM/oNpdE4n3
lPxfsD0j/w+sYJ1xH6Wd8I6JDsbLh0FdhxCqTd2p0JctP8dUcrQ5WpYJjaZa
wVWieOqjEBaZ9o1w19ltgpmu5L/XiY9lvf9hlbPpqJ5oOWymbhAdm98XGohZ
hlofdMuSlrOrOTrPVheEfdrJNRh7rl+HRtGD8kv4Q9YKeO2fIDDUwtGd1vtB
OJCremEl3pVZ7NAR1Z9hiQqFlwd/32FToS59MW40KSz3EEP3XFdg79P2rtJW
jh7X2fXwFLaEJE8=
  "],ExpressionUUID->"155b9e2b-7348-4046-9c0e-317da4ced647"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "[", "\"\<Figure 2/DampingSqdBTable\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Get", "[", 
   "\"\<Bloch Messiah Decompositions/nSpaceFilteredForDampingImprovment\>\"", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9427570640634317`*^9, 3.942757069523382*^9}, {
  3.942762654971277*^9, 
  3.942762658984437*^9}},ExpressionUUID->"ad858825-d361-4880-ba08-\
d18c65ddbe24"],

Cell["Permutation to change qpqp to qqpp ", "Text",
 CellChangeTimes->{{3.923138262913795*^9, 3.923138310837008*^9}, {
   3.923139208002829*^9, 3.923139225283452*^9}, {3.92313937372439*^9, 
   3.9231394586792707`*^9}, {3.923139556613721*^9, 3.923139701274169*^9}, {
   3.923139899556759*^9, 3.923139946625246*^9}, {3.923140033144418*^9, 
   3.923140036670156*^9}, {3.923140078595244*^9, 3.923140108924652*^9}, {
   3.9231402306471*^9, 3.923140426126731*^9}, {3.923146988144936*^9, 
   3.923147047411865*^9}, {3.9233206024384613`*^9, 3.9233206207250633`*^9}, {
   3.923762545537423*^9, 3.9237626502228107`*^9}, {3.923762711739785*^9, 
   3.9237627139745493`*^9}, {3.9237642870084133`*^9, 3.923764432582305*^9}, {
   3.9237644704731607`*^9, 3.9237645217290707`*^9}, {3.923764554504734*^9, 
   3.923764631896927*^9}, {3.923764836912278*^9, 3.923764888302394*^9}, {
   3.9237650269767847`*^9, 3.9237650321831903`*^9}, {3.926016580759432*^9, 
   3.9260165878523703`*^9}, 
   3.926080503224197*^9},ExpressionUUID->"cddba3bc-b1ce-40a8-b73f-\
f7c28e8d41ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalPi]", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"PermutationMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "5", ",", "2", ",", "6", ",", "9", ",", "3", ",", "7", ",", 
       "4", ",", "8", ",", "10"}], "}"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"V0Table", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nSpace", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], ">", 
        RowBox[{"Last", "[", "nSpaceFilteredForDampingImprovment", "]"}]}], 
       ",", 
       RowBox[{"\[CapitalPi]", ".", 
        RowBox[{"Normal", "[", 
         RowBox[{"BlockDiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DecompCheckVTable", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", 
            RowBox[{"DecompCheckVTable", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"DisplacedSqueezedMoments", "[", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"1", "*", "2"}]}], "]"}], ",", " ", 
               RowBox[{"{", "0.", "}"}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], "]"}], ".", 
        RowBox[{"Transpose", "[", "\[CapitalPi]", "]"}]}], ",", 
       RowBox[{"\[CapitalPi]", ".", 
        RowBox[{"Normal", "[", 
         RowBox[{"BlockDiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DecompCheckVTable", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", 
            RowBox[{"DecompCheckVTable", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"DisplacedSqueezedMoments", "[", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"1", "*", "2"}]}], "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  SuperscriptBox["10", 
                   RowBox[{"(", 
                    FractionBox[
                    RowBox[{"DampingSqdBTable", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], "10"], ")"}]], 
                  "]"}], "/", "2"}], "}"}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], "]"}], ".", 
        RowBox[{"Transpose", "[", "\[CapitalPi]", "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9260107299604883`*^9, 3.92601074281938*^9}, {
   3.926010801659822*^9, 3.926010849978709*^9}, {3.926010891317402*^9, 
   3.926010906061314*^9}, {3.926010944672544*^9, 3.926011016600925*^9}, {
   3.926013935019128*^9, 3.926013940743681*^9}, {3.9260156781105947`*^9, 
   3.926015714691814*^9}, {3.9260165123027487`*^9, 3.926016516509128*^9}, {
   3.9260165762160397`*^9, 3.9260165777886887`*^9}, {3.926080523800054*^9, 
   3.92608052568847*^9}, {3.926080558300156*^9, 3.926080558766477*^9}, {
   3.926081499316448*^9, 3.926081501700368*^9}, {3.926081533070003*^9, 
   3.926081558961293*^9}, {3.926081605973361*^9, 3.92608160785601*^9}, {
   3.926081678461545*^9, 3.926081706108699*^9}, {3.9260817852049847`*^9, 
   3.926081788402624*^9}, 3.926507598378932*^9, {3.942757466530443*^9, 
   3.942757501207377*^9}, {3.9427575489709578`*^9, 3.9427575548939133`*^9}, 
   3.942757591796026*^9, {3.942757877096737*^9, 3.942757891216783*^9}, 
   3.9427579721824503`*^9, 3.942758019237361*^9, {3.9427604595707073`*^9, 
   3.942760477133811*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"8064fffe-e3cd-4cf3-8859-ad0f1a465be9"],

Cell["\<\
Create and apply balanced beam splitter transformation for breeding \
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQfd727q1TVm8dj5649QBE64ozBJ4G0lxCmsEg2kRv
eyqInrYntABEz1o8uQZE/zu6og9E/7hQuBxEszCFrAXRQvNVdoDo14VTwbQt
z+W9IPrAtLkHQTT31isXQLQen8tLEB24uEX2PJBm0HurAqIfsPs9VrZ+67jD
ePpTED3JyHDdbyDtoui+G0QHrfl+CEQ36dsfBtFvXB60/wHSdouEZoFoJZXz
80B0T4j5UhB9Qi1gJYhesPnPJhCdZDj3DIg2W8t5GURfcox/AqIj2+ueg+ig
dU5vwObZcr0D0RwZEuoZDm8dRUodwfQqj40sZgnAcNHRYgXRAEdvpYw=
  "],ExpressionUUID->"c1d504a4-9483-464a-99db-940909abf85e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"S", " ", "=", 
   RowBox[{"BSTransform", "[", 
    RowBox[{"5", ",", "3", ",", "4", ",", 
     RowBox[{"1", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"S", ".", 
      RowBox[{"V0Table", "[", 
       RowBox[{"[", "ii", "]"}], "]"}], ".", 
      RowBox[{"Transpose", "[", "S", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.923765114280468*^9, 3.9237651145527897`*^9}, {
  3.924985955852598*^9, 3.924985992815398*^9}, {3.926016716346199*^9, 
  3.926016768255393*^9}, {3.926081861207601*^9, 3.9260818873517303`*^9}, {
  3.942758046925991*^9, 3.942758052277295*^9}, {3.94275890196264*^9, 
  3.9427589044035597`*^9}, {3.942759523832526*^9, 3.942759526032536*^9}},
 CellLabel->
  "In[289]:=",ExpressionUUID->"b6eacda9-6d77-4e8e-8676-95461d853a65"],

Cell["Create and apply QND interaction for damping operation ", "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQfd727q1TVm8dj5649QBE64ozBJ4G0lxCmsEg2kRv
eyqInrYntABEz1o8uQZE/zu6og9E/7hQuBxEszCFrAXRQvNVdoDo14VTwbQt
z+W9IPrAtLkHQTT31isXQLQen8tLEB24uEX2PJBm0HurAqIfsPs9VrZ+67jD
ePpTED3JyHDdbyDtoui+G0QHrfl+CEQ36dsfBtFvXB60/wHSdouEZoFoJZXz
80B0T4j5UhB9Qi1gJYhesPnPJhCdZDj3DIg2W8t5GURfcox/AqIj2+ueg+ig
dU5vwObZcr0D0RwZEuoZDm8dRUodwfQu7TMGILp8fY8hiP5/Zg2rWcJbxz8r
vNlANAAUr684
  "],ExpressionUUID->"061a1bb3-1e25-48e9-8502-8982d180d22f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"S1", " ", "=", 
   RowBox[{"BSTransform", "[", 
    RowBox[{"2", ",", "1", ",", "2", ",", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"5", "+", 
        RowBox[{"Sqrt", "[", "5", "]"}]}], "10"]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S2", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"ArcSinh", "[", 
        FractionBox["1", "2"], "]"}], "]"}], ",", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"ArcSinh", "[", 
         FractionBox["1", "2"], "]"}]}], "]"}], ",", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"ArcSinh", "[", 
         FractionBox["1", "2"], "]"}]}], "]"}], ",", 
      RowBox[{"Exp", "[", 
       RowBox[{"ArcSinh", "[", 
        FractionBox["1", "2"], "]"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S3", " ", "=", 
   RowBox[{"BSTransform", "[", 
    RowBox[{"2", ",", "2", ",", "1", ",", 
     FractionBox[
      RowBox[{"5", "+", 
       RowBox[{"Sqrt", "[", "5", "]"}]}], "10"]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SQND", " ", "=", " ", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"PermutationMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "7", ",", "8", ",", "4", ",", "5", ",", 
        "6", ",", "9", ",", "10"}], "}"}], "]"}], "]"}], ".", 
    RowBox[{"BlockDiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "6", "]"}], ",", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"S3", ".", "S2", ".", "S1"}], "]"}]}], "}"}], "]"}], ".", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Normal", "[", 
      RowBox[{"PermutationMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "2", ",", "3", ",", "7", ",", "8", ",", "4", ",", "5", ",", 
         "6", ",", "9", ",", "10"}], "}"}], "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VPrimeTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nSpace", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], ">", 
        RowBox[{"Last", "[", "nSpaceFilteredForDampingImprovment", "]"}]}], 
       ",", 
       RowBox[{"VTable", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"SQND", ".", 
        RowBox[{"VTable", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], ".", 
        RowBox[{"Transpose", "[", "SQND", "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.923765114280468*^9, 3.9237651145527897`*^9}, {
   3.924985955852598*^9, 3.924985992815398*^9}, {3.926016716346199*^9, 
   3.926016768255393*^9}, {3.926081861207601*^9, 3.9260818873517303`*^9}, {
   3.926081937299426*^9, 3.926081981584032*^9}, {3.9260820580841637`*^9, 
   3.9260820607058697`*^9}, {3.926082117499845*^9, 3.9260821177962837`*^9}, {
   3.926082203944491*^9, 3.926082218777128*^9}, {3.9260822546930933`*^9, 
   3.926082276783049*^9}, {3.9260823506736383`*^9, 3.926082351048856*^9}, {
   3.9260824250596657`*^9, 3.9260825238757563`*^9}, {3.926082561913252*^9, 
   3.926082663200973*^9}, {3.926082718701907*^9, 3.92608295503648*^9}, {
   3.9260830035015707`*^9, 3.9260830338747063`*^9}, {3.926083087195558*^9, 
   3.9260830933461647`*^9}, 3.9260832569369173`*^9, {3.926083335466116*^9, 
   3.926083338119952*^9}, {3.9260838447489557`*^9, 3.9260838473738317`*^9}, {
   3.926083879952381*^9, 3.9260838802214317`*^9}, {3.926083989918126*^9, 
   3.926083998538357*^9}, {3.9260840347622023`*^9, 3.926084117159328*^9}, {
   3.926084318223708*^9, 3.926084391914995*^9}, {3.9260904426246433`*^9, 
   3.926090470380015*^9}, {3.9260905048367987`*^9, 3.926090567341954*^9}, {
   3.9260905986108027`*^9, 3.926090821647764*^9}, 3.926090888071344*^9, {
   3.926090937604381*^9, 3.926091006994864*^9}, {3.942758061864676*^9, 
   3.9427580968891706`*^9}, {3.9427626693256493`*^9, 
   3.942762669728438*^9}},ExpressionUUID->"8955b129-da1c-463a-9767-\
ebf1db6bca93"],

Cell["Performing symplectic diagonalization  ", "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQfd727q1TVm8dj5649QBE64ozBJ4G0lxCmsEg2kRv
eyqInrYntABEz1o8uQZE/zu6og9E/7hQuBxEszCFrAXRQvNVdoDo14VTwbQt
z+W9IPrAtLkHQTT31isXQLQen8tLEB24uEX2PJBm0HurAqIfsPs9VrZ+67jD
ePpTED3JyHDdbyDtoui+G0QHrfl+CEQ36dsfBtFvXB60/wHSdouEZoFoJZXz
80B0T4j5UhB9Qi1gJYhesPnPJhCdZDj3DIg2W8t5GURfcox/AqIj2+ueg+ig
dU5vwObZcr0D0WkSmp9BtM3i1WC6TfAf518gvcrlKBeIvpqVzg+ig5qzBUD0
CWlTURe7t47tv80lQXRDszOfK5BW2ryfH0QDAOzjwBY=
  "],ExpressionUUID->"ca5f9261-18b2-45a3-b7bc-d2a178fcbacc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalOmega]", " ", "=", " ", 
   RowBox[{"OmegaCreate", "[", "Modes", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Db", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{
      RowBox[{"1", "/", "2"}], ",", 
      RowBox[{"2", "*", "Modes"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.924961429360118*^9, 3.924961429591444*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"46fd5ce9-834c-4069-971b-83fd20663240"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VPrimeInvTable", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"4", "*", 
       RowBox[{"(", 
        RowBox[{"\[CapitalOmega]", ".", 
         RowBox[{"VPrimeTable", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], ".", 
         RowBox[{"Transpose", "[", "\[CapitalOmega]", "]"}]}], ")"}]}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"Boole", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"VPrimeInvTable", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "-", 
           RowBox[{"Inverse", "[", 
            RowBox[{"VPrimeTable", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], "]"}], "==", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"10", ",", "10"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "nSpaceFilteredDampingImprovment", "]"}]}], 
         "}"}]}], "]"}], "]"}], "]"}], " ", "==", " ", 
    RowBox[{"Length", "[", "nSpaceFilteredDampingImprovment", "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.92496195569958*^9, {3.9249619867350197`*^9, 3.92496199750469*^9}, {
   3.924962041028084*^9, 3.924962069192005*^9}, 3.924962206727158*^9, {
   3.926091036374711*^9, 3.926091185985725*^9}, {3.926091222461218*^9, 
   3.926091288064266*^9}, 3.926439646471301*^9, {3.926439688305691*^9, 
   3.926439688589217*^9}, 3.942756168630135*^9, 3.942758104859149*^9},
 CellLabel->
  "In[298]:=",ExpressionUUID->"1807f0fd-7885-4446-844e-5fc9617d46fa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Mm12Table", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"MatrixPower", "[", 
      RowBox[{
       RowBox[{"VPrimeInvTable", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"1", "/", "2"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SPrimeTable", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[CapitalOmega]", ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"Mm12Table", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], ".", 
        RowBox[{"MatrixPower", "[", 
         RowBox[{"Db", ",", 
          RowBox[{"1", "/", "2"}]}], "]"}]}], "]"}], ".", 
      RowBox[{"Transpose", "[", "\[CapitalOmega]", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SymplecticQ", " ", "=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"Boole", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"SPrimeTable", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ".", "\[CapitalOmega]", ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"SPrimeTable", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], "-", " ", 
           "\[CapitalOmega]"}], "]"}], "==", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"10", ",", "10"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}], "]"}], 
     "]"}], " ", "==", 
    RowBox[{"Length", "[", "nSpace", "]"}]}]}], 
  RowBox[{"(*", 
   RowBox[{
   "Check", " ", "that", " ", "SPrimes", " ", "are", " ", "symplectic", " ", 
    "matricies"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"Boole", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SPrimeTable", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], ".", "Db", ".", 
          RowBox[{"Transpose", "[", 
           RowBox[{"SPrimeTable", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], "-", 
         RowBox[{"VPrimeTable", "[", 
          RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "==", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"{", 
          RowBox[{"10", ",", "10"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}], "]"}], 
   "]"}], "==", 
  RowBox[{"Length", "[", "nSpace", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Check", " ", "that", " ", "application", " ", "of", " ", "SPrimes", " ", 
     "to", " ", "vacuum", " ", "covariance", " ", "matricies", " ", 
     "recovers", " ", "the", " ", "origonal", " ", "final", " ", "covariance",
      " ", "matricies"}], ",", " ", "VPrimeTable"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.898700694972204*^9, 3.898700754762391*^9}, {
   3.8987008328033953`*^9, 3.898700860488051*^9}, {3.8987022401420927`*^9, 
   3.898702246887166*^9}, 3.898740045964301*^9, {3.898740164007366*^9, 
   3.8987401646686296`*^9}, {3.898790752859653*^9, 3.898790767187953*^9}, {
   3.8987913252214947`*^9, 3.898791345080271*^9}, {3.89879257117656*^9, 
   3.898792588863799*^9}, {3.898793026573833*^9, 3.898793029846437*^9}, 
   3.898793171451357*^9, 3.898793985971415*^9, 3.898794187003953*^9, 
   3.898794268379591*^9, {3.898794322049901*^9, 3.898794322646446*^9}, {
   3.898794428145047*^9, 3.898794429133573*^9}, 3.898794774158915*^9, {
   3.898794963159418*^9, 3.898794963905788*^9}, {3.8987950674769297`*^9, 
   3.898795072631543*^9}, {3.89879527957979*^9, 3.8987952854578876`*^9}, {
   3.898795482756055*^9, 3.898795511827057*^9}, {3.89879559208812*^9, 
   3.8987955958382072`*^9}, {3.8987959427703648`*^9, 3.8987959476700563`*^9}, 
   3.923750253266321*^9, {3.9237505869015636`*^9, 3.9237506473626633`*^9}, {
   3.9237507509254723`*^9, 3.923750756897913*^9}, {3.923765739462687*^9, 
   3.9237657433599443`*^9}, {3.9249620856760073`*^9, 3.924962213316543*^9}, {
   3.924986642504705*^9, 3.9249866517454023`*^9}, {3.926091315991802*^9, 
   3.926091590218275*^9}, {3.926091696052074*^9, 3.9260917053258057`*^9}, {
   3.9427562194698687`*^9, 3.942756291934958*^9}, {3.942758109073986*^9, 
   3.942758122465213*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"c9f30975-ae4a-490b-83c5-3a0fa30d9d2b"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.9260917093532753`*^9, 3.926185098217752*^9, 3.926187071996974*^9, 
   3.926189348994306*^9, 3.926439702296423*^9, 3.926446041748371*^9, 
   3.9427581236707582`*^9, 3.9427589111611567`*^9, 3.942758968260466*^9, 
   3.942759021277932*^9, 3.9427593747444687`*^9, 3.9427595331576*^9, {
   3.942759830162476*^9, 3.942759839882062*^9}, {3.942760471332938*^9, 
   3.942760483698536*^9}},
 CellLabel->
  "Out[301]=",ExpressionUUID->"e3c13d2e-e698-455c-b159-c41ca9c6ec94"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.9260917093532753`*^9, 3.926185098217752*^9, 3.926187071996974*^9, 
   3.926189348994306*^9, 3.926439702296423*^9, 3.926446041748371*^9, 
   3.9427581236707582`*^9, 3.9427589111611567`*^9, 3.942758968260466*^9, 
   3.942759021277932*^9, 3.9427593747444687`*^9, 3.9427595331576*^9, {
   3.942759830162476*^9, 3.942759839882062*^9}, {3.942760471332938*^9, 
   3.942760483699231*^9}},
 CellLabel->
  "Out[302]=",ExpressionUUID->"920364a4-18c7-4516-8fa7-059d5d42639c"]
}, Open  ]],

Cell["Performing Bloch-Messiah Decomposition  ", "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQfd727q1TVm8dj5649QBE64ozBJ4G0lxCmsEg2kRv
eyqInrYntABEz1o8uQZE/zu6og9E/7hQuBxEszCFrAXRQvNVdoDo14VTwbQt
z+W9IPrAtLkHQTT31isXQLQen8tLEB24uEX2PJBm0HurAqIfsPs9VrZ+67jD
ePpTED3JyHDdbyDtoui+G0QHrfl+CEQ36dsfBtFvXB60/wHSdouEZoFoJZXz
80B0T4j5UhB9Qi1gJYhesPnPJhCdZDj3DIg2W8t5GURfcox/AqIj2+ueg+ig
dU5vwObZcr0D0WkSmp9BtM3i1WC6TfAf518gvcrlKBeIvpqVzg+ig5qzBUD0
CWlTURe7t47tv80lQXRDszOfK5BW2ryfH0QbNb9vANHPVmc3g2gANTXIHA==

  "],ExpressionUUID->"9681adf1-e0d9-41c0-8e52-28cc5c7cd957"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SVDTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SingularValueDecomposition", "[", 
      RowBox[{"SPrimeTable", "[", 
       RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SqueezingTransformationTable", " ", "=", " ", 
   RowBox[{"SVDTable", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PassiveTransformationTable", " ", "=", " ", 
   RowBox[{"SVDTable", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"PassiveUnitaryTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PassiveTransformationTable", "[", 
       RowBox[{"[", 
        RowBox[{"ii", ",", 
         RowBox[{"1", ";;", "5"}], ",", 
         RowBox[{"1", ";;", "5"}]}], "]"}], "]"}], "+", 
      RowBox[{"I", "*", 
       RowBox[{"PassiveTransformationTable", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", 
          RowBox[{"6", ";;", "10"}], ",", 
          RowBox[{"1", ";;", "5"}]}], "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"UnitaryTest", " ", "=", " ", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{"Boole", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"UnitaryMatrixQ", "[", 
        RowBox[{"PassiveUnitaryTable", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", " ", 
         RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}], "]"}], 
    "]"}], "==", 
   RowBox[{"Length", "[", "nSpace", "]"}], 
   RowBox[{"(*", 
    RowBox[{
    "Check", " ", "that", " ", "decompostion", " ", "resulted", " ", "in", 
     " ", "unitary", " ", "matrices"}], "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.923849099356821*^9, 3.923849144195628*^9}, {
   3.9238518856061907`*^9, 3.9238519023547792`*^9}, {3.924007937961995*^9, 
   3.924007940917104*^9}, {3.924962389725711*^9, 3.92496242237158*^9}, {
   3.9249624725296717`*^9, 3.9249625102798653`*^9}, {3.924962553528241*^9, 
   3.924962665621153*^9}, {3.924973207941299*^9, 3.924973380065743*^9}, 
   3.925569532369278*^9, {3.926091751978595*^9, 3.9260917629671917`*^9}, 
   3.926507622422166*^9, 3.9427564075427856`*^9, {3.942758135233962*^9, 
   3.942758145662088*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"0e6a5f92-1432-4aef-9ce3-ebae4899aa09"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.924973321837343*^9, {3.924973360629754*^9, 3.9249733844691896`*^9}, 
   3.9249823866125298`*^9, 3.924982495087412*^9, 3.924982739329316*^9, 
   3.92498447656924*^9, 3.92498586964128*^9, 3.924986052192871*^9, 
   3.924986229881742*^9, {3.9249870851806707`*^9, 3.924987094034766*^9}, 
   3.924989005564501*^9, 3.9249895920486593`*^9, 3.9252156427988358`*^9, 
   3.925569529109421*^9, 3.926003855526771*^9, 3.9260918511845627`*^9, {
   3.926185091776436*^9, 3.926185102072527*^9}, 3.926187077170105*^9, 
   3.92618935336615*^9, 3.926439736777771*^9, 3.9264453621598597`*^9, 
   3.9264458107590637`*^9, 3.926446046946952*^9, 3.926449345521461*^9, 
   3.926449399177516*^9, 3.926507624023048*^9, 3.927387017979908*^9, 
   3.942758146270969*^9, 3.942758913744258*^9, 3.942758971566238*^9, 
   3.942759023153233*^9, 3.942759376684204*^9, 3.942759540231965*^9, {
   3.942759833850341*^9, 3.942759841050165*^9}, 3.9427604864298286`*^9},
 CellLabel->
  "Out[307]=",ExpressionUUID->"533df4d0-c4b9-4922-8b2f-4847c3d0c93f"]
}, Open  ]],

Cell["\<\
Extracting squeezing, transmissivities, and phases from unitary matrices    \
\>", "Text",
 CellChangeTimes->{{3.923138262913795*^9, 3.923138310837008*^9}, {
   3.923139208002829*^9, 3.923139225283452*^9}, {3.92313937372439*^9, 
   3.9231394586792707`*^9}, {3.923139556613721*^9, 3.923139701274169*^9}, {
   3.923139899556759*^9, 3.923139946625246*^9}, {3.923140033144418*^9, 
   3.923140036670156*^9}, {3.923140078595244*^9, 3.923140108924652*^9}, {
   3.9231402306471*^9, 3.923140426126731*^9}, {3.923146988144936*^9, 
   3.923147047411865*^9}, {3.9233206024384613`*^9, 3.9233206207250633`*^9}, {
   3.923762545537423*^9, 3.9237626502228107`*^9}, {3.923762711739785*^9, 
   3.9237627139745493`*^9}, {3.9237642870084133`*^9, 3.923764432582305*^9}, {
   3.9237644704731607`*^9, 3.9237645217290707`*^9}, {3.923764554504734*^9, 
   3.923764631896927*^9}, {3.923764836912278*^9, 3.923764888302394*^9}, {
   3.9237650269767847`*^9, 3.923765051954022*^9}, {3.9237650900837793`*^9, 
   3.923765104319976*^9}, {3.9237651452842283`*^9, 3.923765149363676*^9}, {
   3.923765327939639*^9, 3.923765334164632*^9}, {3.923765371231791*^9, 
   3.9237653793597803`*^9}, {3.9249594016596413`*^9, 3.924959433749454*^9}, {
   3.9249613941098022`*^9, 3.924961405990617*^9}, {3.924962311484765*^9, 
   3.9249623313647337`*^9}, {3.9427507792995987`*^9, 3.942750781469099*^9}, {
   3.942750860062933*^9, 3.9427508959151373`*^9}, 
   3.942755266762167*^9},ExpressionUUID->"816c149b-156f-4dbd-bc22-\
30e2183443d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nPhaseFlip", " ", "=", " ", 
   RowBox[{"nSpace", "[", 
    RowBox[{"[", 
     RowBox[{"{", 
      RowBox[{
      "5", ",", "22", ",", "24", ",", "27", ",", "28", ",", "29", ",", "30", 
       ",", "32"}], "}"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PostDampingSqueezingValuesTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"y", "/.", 
        RowBox[{
         RowBox[{"Quiet", "[", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Log", "[", 
                SuperscriptBox["10", 
                 RowBox[{"(", 
                  FractionBox["y", "10"], ")"}]], "]"}], "/", "2"}], " ", "==",
               "x"}], "/.", 
             RowBox[{
              RowBox[{"NSolve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", "x", "]"}], "==", 
                 RowBox[{"SqueezingTransformationTable", "[", 
                  RowBox[{"[", 
                   RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", 
                "x"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "y"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"y", "/.", 
        RowBox[{
         RowBox[{"Quiet", "[", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Log", "[", 
                SuperscriptBox["10", 
                 RowBox[{"(", 
                  FractionBox["y", "10"], ")"}]], "]"}], "/", "2"}], " ", "==",
               "x"}], "/.", 
             RowBox[{
              RowBox[{"NSolve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", "x", "]"}], "==", 
                 RowBox[{"SqueezingTransformationTable", "[", 
                  RowBox[{"[", 
                   RowBox[{"ii", ",", "2", ",", "2"}], "]"}], "]"}]}], ",", 
                "x"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "y"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"y", "/.", 
        RowBox[{
         RowBox[{"Quiet", "[", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Log", "[", 
                SuperscriptBox["10", 
                 RowBox[{"(", 
                  FractionBox["y", "10"], ")"}]], "]"}], "/", "2"}], " ", "==",
               "x"}], "/.", 
             RowBox[{
              RowBox[{"NSolve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", "x", "]"}], "==", 
                 RowBox[{"SqueezingTransformationTable", "[", 
                  RowBox[{"[", 
                   RowBox[{"ii", ",", "3", ",", "3"}], "]"}], "]"}]}], ",", 
                "x"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "y"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"y", "/.", 
        RowBox[{
         RowBox[{"Quiet", "[", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Log", "[", 
                SuperscriptBox["10", 
                 RowBox[{"(", 
                  FractionBox["y", "10"], ")"}]], "]"}], "/", "2"}], " ", "==",
               "x"}], "/.", 
             RowBox[{
              RowBox[{"NSolve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", "x", "]"}], "==", 
                 RowBox[{"SqueezingTransformationTable", "[", 
                  RowBox[{"[", 
                   RowBox[{"ii", ",", "4", ",", "4"}], "]"}], "]"}]}], ",", 
                "x"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "y"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"y", "/.", 
        RowBox[{
         RowBox[{"Quiet", "[", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Log", "[", 
                SuperscriptBox["10", 
                 RowBox[{"(", 
                  FractionBox["y", "10"], ")"}]], "]"}], "/", "2"}], " ", "==",
               "x"}], "/.", 
             RowBox[{
              RowBox[{"NSolve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", "x", "]"}], "==", 
                 RowBox[{"SqueezingTransformationTable", "[", 
                  RowBox[{"[", 
                   RowBox[{"ii", ",", "5", ",", "5"}], "]"}], "]"}]}], ",", 
                "x"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "y"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PostDampingBSandPSTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"nPhaseFlip", ",", 
         RowBox[{"nSpace", "[", 
          RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"Rectangular3PhaseEnd", "[", 
        RowBox[{"PassiveUnitaryTable", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", 
       RowBox[{"RectangularPhaseEnd", "[", 
        RowBox[{"PassiveUnitaryTable", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9249733747126617`*^9, 3.9249733749677753`*^9}, {
   3.924974760271686*^9, 3.924974767140195*^9}, {3.925215034511857*^9, 
   3.925215052905469*^9}, {3.926091858432823*^9, 3.9260918930771923`*^9}, {
   3.926091932203075*^9, 3.926091941102261*^9}, {3.926439785420405*^9, 
   3.926439787135563*^9}, {3.926439884731168*^9, 3.926439893470945*^9}, {
   3.9264402979538307`*^9, 3.92644030640809*^9}, {3.926444122051524*^9, 
   3.926444124003479*^9}, {3.926446155955558*^9, 3.926446157089354*^9}, {
   3.926446274588397*^9, 3.926446274979731*^9}, {3.9264463447538767`*^9, 
   3.926446350156901*^9}, {3.942758150657172*^9, 3.9427581533987637`*^9}, {
   3.942759283679777*^9, 3.9427593211977463`*^9}, {3.942759576049184*^9, 
   3.942759609781602*^9}, 3.942759715908579*^9, 3.942759770119652*^9, {
   3.9427600947061663`*^9, 3.942760103133334*^9}, {3.942760165445991*^9, 
   3.942760167919936*^9}, {3.942760340496282*^9, 3.9427603719564953`*^9}},
 CellLabel->
  "In[308]:=",ExpressionUUID->"c9b263c5-d064-4ed7-8530-4ff49fcf8645"],

Cell["\<\
With the new squeezing values, beam, splitters, and phase shifters we check \
that we get the correct covariance matrix    \
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQfd727q1TVm8dj5649QBE64ozBJ4G0lxCmsEg2kRv
eyqInrYntABEz1o8uQZE/zu6og9E/7hQuBxEszCFrAXRQvNVdoDo14VTwbQt
z+W9IPrAtLkHQTT31isXQLQen8tLEB24uEX2PJBm0HurAqIfsPs9VrZ+67jD
ePpTED3JyHDdbyDtoui+G0QHrfl+CEQ36dsfBtFvXB60/wHSdouEZoFoJZXz
80B0T4j5UhB9Qi1gJYhesPnPJhCdZDj3DIg2W8t5GURfcox/AqIj2+ueg+ig
dU5vwObZcr0D0WkSmp9BtM3i1WC6TfAf518gvcrlKBeIvpqVzg+ig5qzBUD0
CWlTURe7t47tv80lQXRDszOfK5BW2ryfH0QbNb9vANHPVmc3g2jJtexfvIB0
l0HZTxANAPSlz3M=
  "],ExpressionUUID->"13ef5296-2d2d-4c6f-8fc6-93c73caa3e63"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"W", " ", "=", " ", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Sqrt", "[", "2", "]"}]], 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "Modes", "]"}], ",", 
         RowBox[{"IdentityMatrix", "[", "Modes", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "I"}], "*", 
          RowBox[{"IdentityMatrix", "[", "Modes", "]"}]}], ",", 
         RowBox[{"I", "*", 
          RowBox[{"IdentityMatrix", "[", "Modes", "]"}]}]}], "}"}]}], "}"}], 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DecompCheckUnitaryTable", " ", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "<=", 
     RowBox[{"Length", "[", "nSpace", "]"}]}], ",", 
    RowBox[{"ii", "++"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CombinedUnitaryTable", " ", "=", " ", 
      RowBox[{"IdentityMatrix", "[", "Modes", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"kk", "=", "1"}], ",", 
       RowBox[{"kk", "<=", 
        RowBox[{"Length", "[", 
         RowBox[{"PostDampingBSandPSTable", "[", 
          RowBox[{"[", 
           RowBox[{"ii", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CombinedUnitaryTable", " ", "=", " ", 
         RowBox[{"CombinedUnitaryTable", ".", 
          RowBox[{"T", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"PostDampingBSandPSTable", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"kk", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"PostDampingBSandPSTable", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"kk", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"PostDampingBSandPSTable", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"kk", ",", "3"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"PostDampingBSandPSTable", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"kk", ",", "4"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"PostDampingBSandPSTable", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"kk", ",", "5"}], "]"}], "]"}]}], "]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"DecompCheckUnitaryTable", ",", 
       RowBox[{
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{
          RowBox[{"PostDampingBSandPSTable", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], ".", 
        "CombinedUnitaryTable"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}], " "}], "\n", 
 RowBox[{
  RowBox[{"DecompCheckPassiveSymplecticTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"W", ".", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"DecompCheckUnitaryTable", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"Modes", ",", "Modes"}], "}"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"Modes", ",", "Modes"}], "}"}]}], "]"}], ",", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"DecompCheckUnitaryTable", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], "]"}], 
      ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Conjugate", "[", "W", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"DecompCheckActiveSymplecticTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", 
            SuperscriptBox["10", 
             RowBox[{"(", 
              FractionBox[
               RowBox[{"PostDampingSqueezingValuesTable", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "1"}], "]"}], "]"}], "10"], ")"}]], "]"}],
            "/", "2"}], ")"}], "]"}], ",", 
        RowBox[{"Exp", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", 
            SuperscriptBox["10", 
             RowBox[{"(", 
              FractionBox[
               RowBox[{"PostDampingSqueezingValuesTable", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "2"}], "]"}], "]"}], "10"], ")"}]], "]"}],
            "/", "2"}], ")"}], "]"}], ",", 
        RowBox[{"Exp", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", 
            SuperscriptBox["10", 
             RowBox[{"(", 
              FractionBox[
               RowBox[{"PostDampingSqueezingValuesTable", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "3"}], "]"}], "]"}], "10"], ")"}]], "]"}],
            "/", "2"}], ")"}], "]"}], ",", 
        RowBox[{"Exp", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", 
            SuperscriptBox["10", 
             RowBox[{"(", 
              FractionBox[
               RowBox[{"PostDampingSqueezingValuesTable", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "4"}], "]"}], "]"}], "10"], ")"}]], "]"}],
            "/", "2"}], ")"}], "]"}], ",", 
        RowBox[{"Exp", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", 
            SuperscriptBox["10", 
             RowBox[{"(", 
              FractionBox[
               RowBox[{"PostDampingSqueezingValuesTable", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "5"}], "]"}], "]"}], "10"], ")"}]], "]"}],
            "/", "2"}], ")"}], "]"}], ",", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Log", "[", 
             SuperscriptBox["10", 
              RowBox[{"(", 
               FractionBox[
                RowBox[{"PostDampingSqueezingValuesTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"ii", ",", "1"}], "]"}], "]"}], "10"], ")"}]], 
             "]"}], "/", "2"}], ")"}]}], "]"}], ",", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Log", "[", 
             SuperscriptBox["10", 
              RowBox[{"(", 
               FractionBox[
                RowBox[{"PostDampingSqueezingValuesTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"ii", ",", "2"}], "]"}], "]"}], "10"], ")"}]], 
             "]"}], "/", "2"}], ")"}]}], "]"}], ",", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Log", "[", 
             SuperscriptBox["10", 
              RowBox[{"(", 
               FractionBox[
                RowBox[{"PostDampingSqueezingValuesTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"ii", ",", "3"}], "]"}], "]"}], "10"], ")"}]], 
             "]"}], "/", "2"}], ")"}]}], "]"}], ",", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Log", "[", 
             SuperscriptBox["10", 
              RowBox[{"(", 
               FractionBox[
                RowBox[{"PostDampingSqueezingValuesTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"ii", ",", "4"}], "]"}], "]"}], "10"], ")"}]], 
             "]"}], "/", "2"}], ")"}]}], "]"}], ",", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Log", "[", 
             SuperscriptBox["10", 
              RowBox[{"(", 
               FractionBox[
                RowBox[{"PostDampingSqueezingValuesTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"ii", ",", "5"}], "]"}], "]"}], "10"], ")"}]], 
             "]"}], "/", "2"}], ")"}]}], "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"DecompCheckTotalSymplecticTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"DecompCheckPassiveSymplecticTable", "[", 
       RowBox[{"[", "ii", "]"}], "]"}], ".", 
      RowBox[{"DecompCheckActiveSymplecticTable", "[", 
       RowBox[{"[", "ii", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"DecompCheckCovarianceMatrixTable", " ", "=", " ", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DecompCheckTotalSymplecticTable", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ".", "Db", ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"DecompCheckTotalSymplecticTable", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}], "//", 
    "Chop"}]}], ";"}], "\n", 
 RowBox[{"DecompCheck", " ", "=", " ", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{"Boole", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"VPrimeTable", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "-", 
          RowBox[{"DecompCheckCovarianceMatrixTable", "[", 
           RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "==", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "*", "Modes"}], ",", 
            RowBox[{"2", "*", "Modes"}]}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}], "]"}], 
    "]"}], "==", 
   RowBox[{"Length", "[", "nSpace", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.924973840502877*^9, 3.9249738490378304`*^9}, 
   3.924973886026382*^9, {3.924973929961294*^9, 3.9249739771217403`*^9}, 
   3.925215026811924*^9, {3.9252156526703587`*^9, 3.925215653104147*^9}, {
   3.9255695631686783`*^9, 3.9255695688229427`*^9}, {3.9264403299819937`*^9, 
   3.9264403448094053`*^9}, {3.926440476693922*^9, 3.926440480999557*^9}, 
   3.926444157084722*^9, {3.926507666326429*^9, 3.9265076855786657`*^9}, {
   3.942758382905385*^9, 3.942758405935978*^9}, 3.9427586773334503`*^9, 
   3.942759972771613*^9, {3.942760386495829*^9, 3.942760403728249*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"d867f330-b76b-41e9-af86-675c003fa9b4"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.926507682195468*^9, 3.926507686133852*^9}, 
   3.9273870266226397`*^9, {3.9427584396587687`*^9, 3.942758447360383*^9}, 
   3.942758489621642*^9, {3.942758710016848*^9, 3.9427587268787394`*^9}, 
   3.9427589253973618`*^9, 3.9427589840257483`*^9, 3.942759041237811*^9, 
   3.942759628880937*^9, 3.942759785170622*^9, 3.9427599499882097`*^9, 
   3.942759996181244*^9, 3.9427601132206917`*^9, 3.942760177511722*^9, {
   3.9427603981473217`*^9, 3.942760404361992*^9}, 3.9427605121038446`*^9},
 CellLabel->
  "Out[318]=",ExpressionUUID->"ce0fcf1b-bcea-4f47-97bf-fdae54650cc7"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot Max Squeezing", "Section",
 CellChangeTimes->{{3.931454909789013*^9, 3.9314549125328827`*^9}, {
   3.942418126067803*^9, 3.942418130179611*^9}, {3.942418787409634*^9, 
   3.942418794835491*^9}, {3.942421598851054*^9, 3.9424216006650352`*^9}, {
   3.942422754387985*^9, 3.942422755946877*^9}, {3.942455511866585*^9, 
   3.942455516506742*^9}, 3.942510430504285*^9, {3.942755626726407*^9, 
   3.942755667779682*^9}, 3.942757281335228*^9, 
   3.9427620270048532`*^9},ExpressionUUID->"b4d33f05-0702-46f2-b5ee-\
3ae6625df8c9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MaxSqueezing", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"PostDampingSqueezingValuesTable", "[", 
       RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<Figure 2/TargetGKPSq\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotMaxSq", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TargetGKPSq", "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"MaxSqueezing", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P8", " ", "=", " ", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"PlotMaxSq", ",", 
     RowBox[{
     "PlotLabel", "->", 
      "\"\<Max Input Squeezing vs. Target GKP Squeezing\>\""}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(r\), \(GKP\)]\) [dB]\>\"", ",", "Large", 
          ",", " ", "Black"}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(r\), \(Input\)]\) [dB]\>\"", ",", "Large", 
          ",", " ", "Black"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"TicksStyle", "->", 
      RowBox[{"Directive", "[", "24", "]"}]}], ",", 
     RowBox[{"PlotLegends", "->", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"nSpace", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "nSpace", "]"}]}], "}"}]}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "P8", "]"}]}], "Input",
 CellChangeTimes->{{3.926507733613894*^9, 3.926507872154426*^9}, {
   3.927387033681177*^9, 3.927387107954273*^9}, {3.927388241149235*^9, 
   3.92738830169655*^9}, {3.942760610949353*^9, 3.9427606385493727`*^9}, {
   3.942760674533935*^9, 3.942760689068226*^9}, {3.942760722563517*^9, 
   3.942760730449382*^9}, {3.9427607945037317`*^9, 3.942760794717568*^9}, {
   3.942760833296566*^9, 3.942760878581085*^9}, 
   3.942762693054963*^9},ExpressionUUID->"06d700c5-15e8-49ef-b8ea-\
612562fcc284"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{}, 
     InterpretationBox[{
       TagBox[{
         TagBox[{
           RGBColor[0.368417, 0.506779, 0.709798], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{4.01, 17.480794211622243`}, {4.01, 
            17.480794211622243`}}]}, 
          Annotation[#, "Charting`Private`Tag#1"]& ], 
         TagBox[{
           RGBColor[0.880722, 0.611041, 0.142051], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{4.56, 17.779578305389986`}, {4.56, 
            17.779578305389986`}}]}, 
          Annotation[#, "Charting`Private`Tag#2"]& ], 
         TagBox[{
           RGBColor[0.560181, 0.691569, 0.194885], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           PointBox[{{4.91, 18.05452106857741}, {4.91, 18.05452106857741}}]}, 
          Annotation[#, "Charting`Private`Tag#3"]& ], 
         TagBox[{
           RGBColor[0.922526, 0.385626, 0.209179], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           PointBox[{{5.41, 18.32280889223767}, {5.41, 18.32280889223767}}]}, 
          Annotation[#, "Charting`Private`Tag#4"]& ], 
         TagBox[{
           RGBColor[0.528488, 0.470624, 0.701351], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{5.71, 18.569982688879158`}, {5.71, 
            18.569982688879158`}}]}, 
          Annotation[#, "Charting`Private`Tag#5"]& ], 
         TagBox[{
           RGBColor[0.772079, 0.431554, 0.102387], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{6.11, 18.811126931895085`}, {6.11, 
            18.811126931895085`}}]}, 
          Annotation[#, "Charting`Private`Tag#6"]& ], 
         TagBox[{
           RGBColor[0.363898, 0.618501, 0.782349], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{6.41, 19.036753260987087`}, {6.41, 
            19.036753260987087`}}]}, 
          Annotation[#, "Charting`Private`Tag#7"]& ], 
         TagBox[{
           RGBColor[1, 0.75, 0], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{6.71, 19.254543544009618`}, {6.71, 
            19.254543544009618`}}]}, 
          Annotation[#, "Charting`Private`Tag#8"]& ], 
         TagBox[{
           RGBColor[0.647624, 0.37816, 0.614037], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{6.96, 19.460586399976663`}, {6.96, 
            19.460586399976663`}}]}, 
          Annotation[#, "Charting`Private`Tag#9"]& ], 
         TagBox[{
           RGBColor[0.571589, 0.586483, 0.], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{7.21, 19.661784802759062`}, {7.21, 
            19.661784802759062`}}]}, 
          Annotation[#, "Charting`Private`Tag#10"]& ], 
         TagBox[{
           RGBColor[0.915, 0.3325, 0.2125], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{7.41, 19.850026297486487`}, {7.41, 
            19.850026297486487`}}]}, 
          Annotation[#, "Charting`Private`Tag#11"]& ], 
         TagBox[{
           RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{7.66, 20.038911522233146`}, {7.66, 
            20.038911522233146`}}]}, 
          Annotation[#, "Charting`Private`Tag#12"]& ], 
         TagBox[{
           RGBColor[
           0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{7.86, 20.218340135000986`}, {7.86, 
            20.218340135000986`}}]}, 
          Annotation[#, "Charting`Private`Tag#13"]& ], 
         TagBox[{
           RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{8.06, 20.394186765115414`}, {8.06, 
            20.394186765115414`}}]}, 
          Annotation[#, "Charting`Private`Tag#14"]& ], 
         TagBox[{
           RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{8.21, 20.562276146072364`}, {8.21, 
            20.562276146072364`}}]}, 
          Annotation[#, "Charting`Private`Tag#15"]& ], 
         TagBox[{
           RGBColor[0.368417, 0.506779, 0.709798], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{8.36, 20.728120924631664`}, {8.36, 
            20.728120924631664`}}]}, 
          Annotation[#, "Charting`Private`Tag#16"]& ], 
         TagBox[{
           RGBColor[0.880722, 0.611041, 0.142051], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           PointBox[{{8.51, 20.89082224649372}, {8.51, 20.89082224649372}}]}, 
          Annotation[#, "Charting`Private`Tag#17"]& ], 
         TagBox[{
           RGBColor[0.560181, 0.691569, 0.194885], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           PointBox[{{8.66, 21.05902774062934}, {8.66, 21.05902774062934}}]}, 
          Annotation[#, "Charting`Private`Tag#18"]& ], 
         TagBox[{
           RGBColor[0.922526, 0.385626, 0.209179], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           PointBox[{{8.81, 21.23201928137013}, {8.81, 21.23201928137013}}]}, 
          Annotation[#, "Charting`Private`Tag#19"]& ], 
         TagBox[{
           RGBColor[0.528488, 0.470624, 0.701351], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           PointBox[{{8.96, 21.42842163401562}, {8.96, 21.42842163401562}}]}, 
          Annotation[#, "Charting`Private`Tag#20"]& ], 
         TagBox[{
           RGBColor[0.772079, 0.431554, 0.102387], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           PointBox[{{9.31, 20.85268833704467}, {9.31, 20.85268833704467}}]}, 
          Annotation[#, "Charting`Private`Tag#21"]& ], 
         TagBox[{
           RGBColor[0.363898, 0.618501, 0.782349], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{9.36, 20.992972877394628`}, {9.36, 
            20.992972877394628`}}]}, 
          Annotation[#, "Charting`Private`Tag#22"]& ], 
         TagBox[{
           RGBColor[1, 0.75, 0], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           PointBox[{{9.41, 21.12887944383211}, {9.41, 21.12887944383211}}]}, 
          Annotation[#, "Charting`Private`Tag#23"]& ], 
         TagBox[{
           RGBColor[0.647624, 0.37816, 0.614037], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{9.46, 21.260672172457774`}, {9.46, 
            21.260672172457774`}}]}, 
          Annotation[#, "Charting`Private`Tag#24"]& ], 
         TagBox[{
           RGBColor[0.571589, 0.586483, 0.], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           PointBox[{{9.56, 21.38859208327956}, {9.56, 21.38859208327956}}]}, 
          Annotation[#, "Charting`Private`Tag#25"]& ], 
         TagBox[{
           RGBColor[0.915, 0.3325, 0.2125], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{9.610000000000001, 21.512859689431824`}, {
            9.610000000000001, 21.512859689431824`}}]}, 
          Annotation[#, "Charting`Private`Tag#26"]& ], 
         TagBox[{
           RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{9.66, 21.633677250223034`}, {9.66, 
            21.633677250223034`}}]}, 
          Annotation[#, "Charting`Private`Tag#27"]& ], 
         TagBox[{
           RGBColor[
           0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{9.71, 21.751230724457727`}, {9.71, 
            21.751230724457727`}}]}, 
          Annotation[#, "Charting`Private`Tag#28"]& ], 
         TagBox[{
           RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{9.76, 21.865691470384018`}, {9.76, 
            21.865691470384018`}}]}, 
          Annotation[#, "Charting`Private`Tag#29"]& ], 
         TagBox[{
           RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{9.81, 21.977217730516966`}, {9.81, 
            21.977217730516966`}}]}, 
          Annotation[#, "Charting`Private`Tag#30"]& ], 
         TagBox[{
           RGBColor[0.368417, 0.506779, 0.709798], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{9.96, 22.192041836310956`}, {9.96, 
            22.192041836310956`}}]}, 
          Annotation[#, "Charting`Private`Tag#31"]& ], 
         TagBox[{
           RGBColor[0.880722, 0.611041, 0.142051], 
           PointSize[0.012833333333333334`], 
           AbsoluteThickness[2], 
           
           PointBox[{{10.06, 22.39675236977025}, {10.06, 
            22.39675236977025}}]}, 
          Annotation[#, "Charting`Private`Tag#32"]& ]}, {
        "WolframDynamicHighlight", <|
         "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>}], 
       DynamicBox[
        (Charting`HighlightActionBox["DynamicHighlight", {}, 
         Slot["HighlightElements"], 
         Slot["LayoutOptions"], 
         Slot["Meta"], 
         Charting`HighlightActionFunction["DynamicHighlight", {{
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.368417, 0.506779, 0.709798], 
               AbsoluteThickness[2]], 
              
              Point[{{4.01, 17.480794211622243`}, {4.01, 
               17.480794211622243`}}]}, "Charting`Private`Tag#1"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.880722, 0.611041, 0.142051], 
               AbsoluteThickness[2]], 
              
              Point[{{4.56, 17.779578305389986`}, {4.56, 
               17.779578305389986`}}]}, "Charting`Private`Tag#2"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.560181, 0.691569, 0.194885], 
               AbsoluteThickness[2]], 
              Point[{{4.91, 18.05452106857741}, {4.91, 18.05452106857741}}]}, 
             "Charting`Private`Tag#3"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.922526, 0.385626, 0.209179], 
               AbsoluteThickness[2]], 
              Point[{{5.41, 18.32280889223767}, {5.41, 18.32280889223767}}]}, 
             "Charting`Private`Tag#4"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.528488, 0.470624, 0.701351], 
               AbsoluteThickness[2]], 
              
              Point[{{5.71, 18.569982688879158`}, {5.71, 
               18.569982688879158`}}]}, "Charting`Private`Tag#5"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.772079, 0.431554, 0.102387], 
               AbsoluteThickness[2]], 
              
              Point[{{6.11, 18.811126931895085`}, {6.11, 
               18.811126931895085`}}]}, "Charting`Private`Tag#6"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.363898, 0.618501, 0.782349], 
               AbsoluteThickness[2]], 
              
              Point[{{6.41, 19.036753260987087`}, {6.41, 
               19.036753260987087`}}]}, "Charting`Private`Tag#7"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[1, 0.75, 0], 
               AbsoluteThickness[2]], 
              
              Point[{{6.71, 19.254543544009618`}, {6.71, 
               19.254543544009618`}}]}, "Charting`Private`Tag#8"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.647624, 0.37816, 0.614037], 
               AbsoluteThickness[2]], 
              
              Point[{{6.96, 19.460586399976663`}, {6.96, 
               19.460586399976663`}}]}, "Charting`Private`Tag#9"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.571589, 0.586483, 0.], 
               AbsoluteThickness[2]], 
              
              Point[{{7.21, 19.661784802759062`}, {7.21, 
               19.661784802759062`}}]}, "Charting`Private`Tag#10"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.915, 0.3325, 0.2125], 
               AbsoluteThickness[2]], 
              
              Point[{{7.41, 19.850026297486487`}, {7.41, 
               19.850026297486487`}}]}, "Charting`Private`Tag#11"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
               AbsoluteThickness[2]], 
              
              Point[{{7.66, 20.038911522233146`}, {7.66, 
               20.038911522233146`}}]}, "Charting`Private`Tag#12"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[
               0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
               AbsoluteThickness[2]], 
              
              Point[{{7.86, 20.218340135000986`}, {7.86, 
               20.218340135000986`}}]}, "Charting`Private`Tag#13"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
               AbsoluteThickness[2]], 
              
              Point[{{8.06, 20.394186765115414`}, {8.06, 
               20.394186765115414`}}]}, "Charting`Private`Tag#14"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
               AbsoluteThickness[2]], 
              
              Point[{{8.21, 20.562276146072364`}, {8.21, 
               20.562276146072364`}}]}, "Charting`Private`Tag#15"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.368417, 0.506779, 0.709798], 
               AbsoluteThickness[2]], 
              
              Point[{{8.36, 20.728120924631664`}, {8.36, 
               20.728120924631664`}}]}, "Charting`Private`Tag#16"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.880722, 0.611041, 0.142051], 
               AbsoluteThickness[2]], 
              Point[{{8.51, 20.89082224649372}, {8.51, 20.89082224649372}}]}, 
             "Charting`Private`Tag#17"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.560181, 0.691569, 0.194885], 
               AbsoluteThickness[2]], 
              Point[{{8.66, 21.05902774062934}, {8.66, 21.05902774062934}}]}, 
             "Charting`Private`Tag#18"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.922526, 0.385626, 0.209179], 
               AbsoluteThickness[2]], 
              Point[{{8.81, 21.23201928137013}, {8.81, 21.23201928137013}}]}, 
             "Charting`Private`Tag#19"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.528488, 0.470624, 0.701351], 
               AbsoluteThickness[2]], 
              Point[{{8.96, 21.42842163401562}, {8.96, 21.42842163401562}}]}, 
             "Charting`Private`Tag#20"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.772079, 0.431554, 0.102387], 
               AbsoluteThickness[2]], 
              Point[{{9.31, 20.85268833704467}, {9.31, 20.85268833704467}}]}, 
             "Charting`Private`Tag#21"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.363898, 0.618501, 0.782349], 
               AbsoluteThickness[2]], 
              
              Point[{{9.36, 20.992972877394628`}, {9.36, 
               20.992972877394628`}}]}, "Charting`Private`Tag#22"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[1, 0.75, 0], 
               AbsoluteThickness[2]], 
              Point[{{9.41, 21.12887944383211}, {9.41, 21.12887944383211}}]}, 
             "Charting`Private`Tag#23"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.647624, 0.37816, 0.614037], 
               AbsoluteThickness[2]], 
              
              Point[{{9.46, 21.260672172457774`}, {9.46, 
               21.260672172457774`}}]}, "Charting`Private`Tag#24"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.571589, 0.586483, 0.], 
               AbsoluteThickness[2]], 
              Point[{{9.56, 21.38859208327956}, {9.56, 21.38859208327956}}]}, 
             "Charting`Private`Tag#25"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.915, 0.3325, 0.2125], 
               AbsoluteThickness[2]], 
              
              Point[{{9.610000000000001, 21.512859689431824`}, {
               9.610000000000001, 21.512859689431824`}}]}, 
             "Charting`Private`Tag#26"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
               AbsoluteThickness[2]], 
              
              Point[{{9.66, 21.633677250223034`}, {9.66, 
               21.633677250223034`}}]}, "Charting`Private`Tag#27"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[
               0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
               AbsoluteThickness[2]], 
              
              Point[{{9.71, 21.751230724457727`}, {9.71, 
               21.751230724457727`}}]}, "Charting`Private`Tag#28"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
               AbsoluteThickness[2]], 
              
              Point[{{9.76, 21.865691470384018`}, {9.76, 
               21.865691470384018`}}]}, "Charting`Private`Tag#29"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
               AbsoluteThickness[2]], 
              
              Point[{{9.81, 21.977217730516966`}, {9.81, 
               21.977217730516966`}}]}, "Charting`Private`Tag#30"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.368417, 0.506779, 0.709798], 
               AbsoluteThickness[2]], 
              
              Point[{{9.96, 22.192041836310956`}, {9.96, 
               22.192041836310956`}}]}, "Charting`Private`Tag#31"], 
            Annotation[{
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.880722, 0.611041, 0.142051], 
               AbsoluteThickness[2]], 
              
              Point[{{10.06, 22.39675236977025}, {10.06, 
               22.39675236977025}}]}, "Charting`Private`Tag#32"]}}, <|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
           "LayoutOptions" -> <|
            "PlotRange" -> {{3.8839583333333416`, 10.06}, {
              17.207685425058504`, 22.39675236977025}}, 
             "Frame" -> {{False, False}, {False, False}}, 
             "AxesOrigin" -> {3.8839583333333416`, 17.207685425058504`}, 
             "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
             "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.880722, 0.611041, 0.142051], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.368417, 0.506779, 0.709798], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[
                0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.915, 0.3325, 0.2125], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.571589, 0.586483, 0.], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.647624, 0.37816, 0.614037], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[1, 0.75, 0], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.363898, 0.618501, 0.782349], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.772079, 0.431554, 0.102387], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.528488, 0.470624, 0.701351], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.922526, 0.385626, 0.209179], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.560181, 0.691569, 0.194885], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.880722, 0.611041, 0.142051], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.368417, 0.506779, 0.709798], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[
                0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.915, 0.3325, 0.2125], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.571589, 0.586483, 0.], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.647624, 0.37816, 0.614037], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[1, 0.75, 0], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.363898, 0.618501, 0.782349], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.772079, 0.431554, 0.102387], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.528488, 0.470624, 0.701351], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.922526, 0.385626, 0.209179], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.560181, 0.691569, 0.194885], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.880722, 0.611041, 0.142051], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.368417, 0.506779, 0.709798], 
                AbsoluteThickness[2]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 Identity[
                  Part[#, 1]], 
                 Identity[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> ListPlot, "GroupHighlight" -> False|>|>]]& )[<|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
          "LayoutOptions" -> <|
           "PlotRange" -> {{3.8839583333333416`, 10.06}, {17.207685425058504`,
              22.39675236977025}}, 
            "Frame" -> {{False, False}, {False, False}}, 
            "AxesOrigin" -> {3.8839583333333416`, 17.207685425058504`}, 
            "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
            "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.880722, 0.611041, 0.142051], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.368417, 0.506779, 0.709798], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[
               0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.915, 0.3325, 0.2125], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.571589, 0.586483, 0.], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.647624, 0.37816, 0.614037], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[1, 0.75, 0], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.363898, 0.618501, 0.782349], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.772079, 0.431554, 0.102387], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.528488, 0.470624, 0.701351], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.922526, 0.385626, 0.209179], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.560181, 0.691569, 0.194885], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.880722, 0.611041, 0.142051], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.368417, 0.506779, 0.709798], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[
               0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.915, 0.3325, 0.2125], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.571589, 0.586483, 0.], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.647624, 0.37816, 0.614037], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[1, 0.75, 0], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.363898, 0.618501, 0.782349], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.772079, 0.431554, 0.102387], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.528488, 0.470624, 0.701351], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.922526, 0.385626, 0.209179], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.560181, 0.691569, 0.194885], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.880722, 0.611041, 0.142051], 
               AbsoluteThickness[2]], 
              Directive[
               PointSize[0.012833333333333334`], 
               RGBColor[0.368417, 0.506779, 0.709798], 
               AbsoluteThickness[2]]}, 
            "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                Identity[
                 Part[#, 1]], 
                Identity[
                 Part[#, 2]]}& ), 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            ListPlot, "GroupHighlight" -> False|>|>], 
        ImageSizeCache -> {{4.503599627370496*^15, -4.503599627370496*^15}, {
         4.503599627370496*^15, -4.503599627370496*^15}}]}, 
      Annotation[{{
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.368417, 0.506779, 0.709798], 
            AbsoluteThickness[2]], 
           Point[{{4.01, 17.480794211622243`}, {4.01, 17.480794211622243`}}]},
           "Charting`Private`Tag#1"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.880722, 0.611041, 0.142051], 
            AbsoluteThickness[2]], 
           Point[{{4.56, 17.779578305389986`}, {4.56, 17.779578305389986`}}]},
           "Charting`Private`Tag#2"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.560181, 0.691569, 0.194885], 
            AbsoluteThickness[2]], 
           Point[{{4.91, 18.05452106857741}, {4.91, 18.05452106857741}}]}, 
          "Charting`Private`Tag#3"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.922526, 0.385626, 0.209179], 
            AbsoluteThickness[2]], 
           Point[{{5.41, 18.32280889223767}, {5.41, 18.32280889223767}}]}, 
          "Charting`Private`Tag#4"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.528488, 0.470624, 0.701351], 
            AbsoluteThickness[2]], 
           Point[{{5.71, 18.569982688879158`}, {5.71, 18.569982688879158`}}]},
           "Charting`Private`Tag#5"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.772079, 0.431554, 0.102387], 
            AbsoluteThickness[2]], 
           Point[{{6.11, 18.811126931895085`}, {6.11, 18.811126931895085`}}]},
           "Charting`Private`Tag#6"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.363898, 0.618501, 0.782349], 
            AbsoluteThickness[2]], 
           Point[{{6.41, 19.036753260987087`}, {6.41, 19.036753260987087`}}]},
           "Charting`Private`Tag#7"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[1, 0.75, 0], 
            AbsoluteThickness[2]], 
           Point[{{6.71, 19.254543544009618`}, {6.71, 19.254543544009618`}}]},
           "Charting`Private`Tag#8"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.647624, 0.37816, 0.614037], 
            AbsoluteThickness[2]], 
           Point[{{6.96, 19.460586399976663`}, {6.96, 19.460586399976663`}}]},
           "Charting`Private`Tag#9"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.571589, 0.586483, 0.], 
            AbsoluteThickness[2]], 
           Point[{{7.21, 19.661784802759062`}, {7.21, 19.661784802759062`}}]},
           "Charting`Private`Tag#10"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.915, 0.3325, 0.2125], 
            AbsoluteThickness[2]], 
           Point[{{7.41, 19.850026297486487`}, {7.41, 19.850026297486487`}}]},
           "Charting`Private`Tag#11"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
            AbsoluteThickness[2]], 
           Point[{{7.66, 20.038911522233146`}, {7.66, 20.038911522233146`}}]},
           "Charting`Private`Tag#12"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[
            0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
            AbsoluteThickness[2]], 
           Point[{{7.86, 20.218340135000986`}, {7.86, 20.218340135000986`}}]},
           "Charting`Private`Tag#13"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
            AbsoluteThickness[2]], 
           Point[{{8.06, 20.394186765115414`}, {8.06, 20.394186765115414`}}]},
           "Charting`Private`Tag#14"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
            AbsoluteThickness[2]], 
           Point[{{8.21, 20.562276146072364`}, {8.21, 20.562276146072364`}}]},
           "Charting`Private`Tag#15"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.368417, 0.506779, 0.709798], 
            AbsoluteThickness[2]], 
           Point[{{8.36, 20.728120924631664`}, {8.36, 20.728120924631664`}}]},
           "Charting`Private`Tag#16"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.880722, 0.611041, 0.142051], 
            AbsoluteThickness[2]], 
           Point[{{8.51, 20.89082224649372}, {8.51, 20.89082224649372}}]}, 
          "Charting`Private`Tag#17"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.560181, 0.691569, 0.194885], 
            AbsoluteThickness[2]], 
           Point[{{8.66, 21.05902774062934}, {8.66, 21.05902774062934}}]}, 
          "Charting`Private`Tag#18"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.922526, 0.385626, 0.209179], 
            AbsoluteThickness[2]], 
           Point[{{8.81, 21.23201928137013}, {8.81, 21.23201928137013}}]}, 
          "Charting`Private`Tag#19"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.528488, 0.470624, 0.701351], 
            AbsoluteThickness[2]], 
           Point[{{8.96, 21.42842163401562}, {8.96, 21.42842163401562}}]}, 
          "Charting`Private`Tag#20"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.772079, 0.431554, 0.102387], 
            AbsoluteThickness[2]], 
           Point[{{9.31, 20.85268833704467}, {9.31, 20.85268833704467}}]}, 
          "Charting`Private`Tag#21"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.363898, 0.618501, 0.782349], 
            AbsoluteThickness[2]], 
           Point[{{9.36, 20.992972877394628`}, {9.36, 20.992972877394628`}}]},
           "Charting`Private`Tag#22"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[1, 0.75, 0], 
            AbsoluteThickness[2]], 
           Point[{{9.41, 21.12887944383211}, {9.41, 21.12887944383211}}]}, 
          "Charting`Private`Tag#23"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.647624, 0.37816, 0.614037], 
            AbsoluteThickness[2]], 
           Point[{{9.46, 21.260672172457774`}, {9.46, 21.260672172457774`}}]},
           "Charting`Private`Tag#24"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.571589, 0.586483, 0.], 
            AbsoluteThickness[2]], 
           Point[{{9.56, 21.38859208327956}, {9.56, 21.38859208327956}}]}, 
          "Charting`Private`Tag#25"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.915, 0.3325, 0.2125], 
            AbsoluteThickness[2]], 
           
           Point[{{9.610000000000001, 21.512859689431824`}, {
            9.610000000000001, 21.512859689431824`}}]}, 
          "Charting`Private`Tag#26"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
            AbsoluteThickness[2]], 
           Point[{{9.66, 21.633677250223034`}, {9.66, 21.633677250223034`}}]},
           "Charting`Private`Tag#27"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[
            0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
            AbsoluteThickness[2]], 
           Point[{{9.71, 21.751230724457727`}, {9.71, 21.751230724457727`}}]},
           "Charting`Private`Tag#28"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
            AbsoluteThickness[2]], 
           Point[{{9.76, 21.865691470384018`}, {9.76, 21.865691470384018`}}]},
           "Charting`Private`Tag#29"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
            AbsoluteThickness[2]], 
           Point[{{9.81, 21.977217730516966`}, {9.81, 21.977217730516966`}}]},
           "Charting`Private`Tag#30"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.368417, 0.506779, 0.709798], 
            AbsoluteThickness[2]], 
           Point[{{9.96, 22.192041836310956`}, {9.96, 22.192041836310956`}}]},
           "Charting`Private`Tag#31"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.880722, 0.611041, 0.142051], 
            AbsoluteThickness[2]], 
           Point[{{10.06, 22.39675236977025}, {10.06, 22.39675236977025}}]}, 
          "Charting`Private`Tag#32"]}}, <|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
        "LayoutOptions" -> <|
         "PlotRange" -> {{3.8839583333333416`, 10.06}, {17.207685425058504`, 
           22.39675236977025}}, "Frame" -> {{False, False}, {False, False}}, 
          "AxesOrigin" -> {3.8839583333333416`, 17.207685425058504`}, 
          "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
          "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.880722, 0.611041, 0.142051], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[
             0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.915, 0.3325, 0.2125], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.571589, 0.586483, 0.], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.647624, 0.37816, 0.614037], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[1, 0.75, 0], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.363898, 0.618501, 0.782349], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.772079, 0.431554, 0.102387], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.528488, 0.470624, 0.701351], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.922526, 0.385626, 0.209179], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.560181, 0.691569, 0.194885], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.880722, 0.611041, 0.142051], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[
             0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.915, 0.3325, 0.2125], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.571589, 0.586483, 0.], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.647624, 0.37816, 0.614037], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[1, 0.75, 0], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.363898, 0.618501, 0.782349], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.772079, 0.431554, 0.102387], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.528488, 0.470624, 0.701351], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.922526, 0.385626, 0.209179], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.560181, 0.691569, 0.194885], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.880722, 0.611041, 0.142051], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              Identity[
               Part[#, 1]], 
              Identity[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          ListPlot, "GroupHighlight" -> False|>|>, 
       "DynamicHighlight"]], {{}, {}}}, AspectRatio -> 
    NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
    AxesLabel -> {
      FormBox[
       TagBox[
        StyleBox[
        "\"\\!\\(\\*SubscriptBox[\\(r\\), \\(GKP\\)]\\) [dB]\"", Large, 
         GrayLevel[0], StripOnInput -> False], HoldForm], TraditionalForm], 
      FormBox[
       TagBox[
        StyleBox[
        "\"\\!\\(\\*SubscriptBox[\\(r\\), \\(Input\\)]\\) [dB]\"", Large, 
         GrayLevel[0], StripOnInput -> False], HoldForm], TraditionalForm]}, 
    AxesOrigin -> {3.8839583333333416`, 17.207685425058504`}, DisplayFunction -> 
    Identity, Frame -> {{False, False}, {False, False}}, 
    FrameLabel -> {{None, None}, {None, None}}, 
    FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
    GridLines -> {None, None}, GridLinesStyle -> Directive[
      GrayLevel[0.5, 0.4]], ImageSize -> {684.3802083333335, Automatic}, 
    Method -> {
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
        Directive[
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.528488, 0.470624, 0.701351], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.772079, 0.431554, 0.102387], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.363898, 0.618501, 0.782349], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[1, 0.75, 0], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.647624, 0.37816, 0.614037], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.571589, 0.586483, 0.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.915, 0.3325, 0.2125], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
         AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
      "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05],
       "OptimizePlotMarkers" -> True, "IncludeHighlighting" -> "CurrentPoint",
       "HighlightStyle" -> Automatic, "OptimizePlotMarkers" -> True, 
      "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          Identity[
           Part[#, 1]], 
          Identity[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          Identity[
           Part[#, 1]], 
          Identity[
           Part[#, 2]]}& )}}, PlotLabel -> 
    FormBox["\"Max Input Squeezing vs. Target GKP Squeezing\"", 
      TraditionalForm], 
    PlotRange -> {{3.8839583333333416`, 10.06}, {17.207685425058504`, 
     22.39675236977025}}, PlotRangeClipping -> True, PlotRangePadding -> {{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.05], 
       Scaled[0.05]}}, Ticks -> {Automatic, Automatic}, TicksStyle -> 
    Directive[24]], 
   FormBox[
    FormBox[
     TemplateBox[{
      "\"7\"", "\"8\"", "\"9\"", "\"10\"", "\"11\"", "\"12\"", "\"13\"", 
       "\"14\"", "\"15\"", "\"16\"", "\"17\"", "\"18\"", "\"19\"", "\"20\"", 
       "\"21\"", "\"22\"", "\"23\"", "\"24\"", "\"25\"", "\"26\"", "\"27\"", 
       "\"28\"", "\"29\"", "\"30\"", "\"31\"", "\"32\"", "\"33\"", "\"34\"", 
       "\"35\"", "\"36\"", "\"38\"", "\"40\""}, "PointLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #2}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #3}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #4}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #5}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #6}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #7}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[1, 0.75, 0], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[1, 0.75, 0], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #8}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.647624, 0.37816, 0.614037], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.647624, 0.37816, 0.614037], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #9}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"], 
               TagBox[
                GridBox[{{
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.571589, 0.586483, 0.], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.571589, 0.586483, 0.], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #10}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.915, 0.3325, 0.2125], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.915, 0.3325, 0.2125], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #11}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
                    
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
                    
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #12}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[
                    0.9728288904374106, 0.621644452187053, 
                    0.07336199581899142], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[
                    0.9728288904374106, 0.621644452187053, 
                    0.07336199581899142], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #13}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #14}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #15}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #16}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #17}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #18}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"], 
               TagBox[
                GridBox[{{
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #19}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #20}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #21}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #22}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[1, 0.75, 0], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[1, 0.75, 0], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #23}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.647624, 0.37816, 0.614037], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.647624, 0.37816, 0.614037], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #24}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.571589, 0.586483, 0.], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.571589, 0.586483, 0.], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #25}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.915, 0.3325, 0.2125], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.915, 0.3325, 0.2125], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #26}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
                    
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
                    
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #27}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"], 
               TagBox[
                GridBox[{{
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[
                    0.9728288904374106, 0.621644452187053, 
                    0.07336199581899142], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[
                    0.9728288904374106, 0.621644452187053, 
                    0.07336199581899142], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #28}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #29}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #30}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #31}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[2]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[2]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #32}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.922526, 0.385626, 0.209179]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.528488, 0.470624, 0.701351]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.772079, 0.431554, 0.102387]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.363898, 0.618501, 0.782349]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|"color" -> RGBColor[1, 0.75, 0]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.647624, 0.37816, 0.614037]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.571589, 0.586483, 0.]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|"color" -> RGBColor[0.915, 0.3325, 0.2125]|>,
                     "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> 
                    RGBColor[
                    0.40082222609352647`, 0.5220066643438841, 0.85]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> 
                    RGBColor[
                    0.9728288904374106, 0.621644452187053, 
                    0.07336199581899142]|>, "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> 
                    RGBColor[0.736782672705901, 0.358, 0.5030266573755369]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> 
                    RGBColor[
                    0.28026441037696703`, 0.715, 0.4292089322474965]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.922526, 0.385626, 0.209179]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.528488, 0.470624, 0.701351]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.772079, 0.431554, 0.102387]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.363898, 0.618501, 0.782349]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|"color" -> RGBColor[1, 0.75, 0]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.647624, 0.37816, 0.614037]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.571589, 0.586483, 0.]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|"color" -> RGBColor[0.915, 0.3325, 0.2125]|>,
                     "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> 
                    RGBColor[
                    0.40082222609352647`, 0.5220066643438841, 0.85]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> 
                    RGBColor[
                    0.9728288904374106, 0.621644452187053, 
                    0.07336199581899142]|>, "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> 
                    RGBColor[0.736782672705901, 0.358, 0.5030266573755369]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> 
                    RGBColor[
                    0.28026441037696703`, 0.715, 0.4292089322474965]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], 
             "}"}], ",", 
           RowBox[{"{", 
             
             RowBox[{#, ",", #2, ",", #3, ",", #4, ",", #5, ",", #6, ",", #7, 
               ",", #8, ",", #9, ",", #10, ",", #11, ",", #12, ",", #13, 
               ",", #14, ",", #15, ",", #16, ",", #17, ",", #18, ",", #19, 
               ",", #20, ",", #21, ",", #22, ",", #23, ",", #24, ",", #25, 
               ",", #26, ",", #27, ",", #28, ",", #29, ",", #30, ",", #31, 
               ",", #32}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               
               RowBox[{
                "False", ",", "False", ",", "False", ",", "False", ",", 
                 "False", ",", "False", ",", "False", ",", "False", ",", 
                 "False", ",", "False", ",", "False", ",", "False", ",", 
                 "False", ",", "False", ",", "False", ",", "False", ",", 
                 "False", ",", "False", ",", "False", ",", "False", ",", 
                 "False", ",", "False", ",", "False", ",", "False", ",", 
                 "False", ",", "False", ",", "False", ",", "False", ",", 
                 "False", ",", "False", ",", "False", ",", "False"}], "}"}]}],
            ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.942760863064836*^9, 3.942760879183433*^9}},
 CellLabel->
  "Out[344]=",ExpressionUUID->"53e6f192-997e-4440-ae56-b15d297a3fc9"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942760841171895*^9, 
  3.942760856383654*^9}},ExpressionUUID->"311814c3-c0ea-41c7-8eb9-\
55224c33ede8"]
}, Closed]]
}, Open  ]]
},
WindowSize->{1920, 1027},
WindowMargins->{{Automatic, 1024}, {-169, Automatic}},
Magnification:>1.5 Inherited,
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8c4dbf2c-bc86-4268-aa5c-c2c37e7a6f28"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 315, 5, 146, "Title",ExpressionUUID->"5911a561-237d-4ae9-b765-4585e1555d14"],
Cell[898, 29, 724, 12, 122, "Text",ExpressionUUID->"675ed024-5276-4b1a-bb78-9c3a0477396e"],
Cell[CellGroupData[{
Cell[1647, 45, 205, 4, 101, "Section",ExpressionUUID->"5f477446-0204-44e2-a5b3-20b32f4aff3a"],
Cell[1855, 51, 66814, 1608, 7494, "Input",ExpressionUUID->"f47d3320-deba-4e1a-9cae-f32e041b24e7"]
}, Closed]],
Cell[CellGroupData[{
Cell[68706, 1664, 275, 4, 78, "Section",ExpressionUUID->"98b08b24-455b-4fb6-92f6-7ba64d088018"],
Cell[68984, 1670, 462, 13, 46, "Input",ExpressionUUID->"ae8de968-2903-4971-b437-809163889169"],
Cell[69449, 1685, 600, 10, 88, "Text",ExpressionUUID->"6a095cbb-1b72-4abd-9292-6fb6ef5d7ab5"],
Cell[70052, 1697, 1041, 28, 46, "Input",ExpressionUUID->"99a086a2-9ca6-4efb-a955-0143208e0de2"],
Cell[71096, 1727, 881, 14, 53, "Text",ExpressionUUID->"f8bb3946-d093-4c87-b864-e8c3aadd8fad"],
Cell[71980, 1743, 921, 23, 71, "Input",ExpressionUUID->"0dc0bbf0-2dbd-44d7-8108-6cb989387435"],
Cell[72904, 1768, 1189, 19, 53, "Text",ExpressionUUID->"32fa2425-d9f1-4377-9c14-15adb6557685"],
Cell[CellGroupData[{
Cell[74118, 1791, 1554, 39, 111, "Input",ExpressionUUID->"3b637bdc-0f2b-4fe2-a09d-2ff793cf503f"],
Cell[75675, 1832, 629, 16, 74, "Output",ExpressionUUID->"5d873c30-c126-4026-82f5-8fe747f55ef8"]
}, Open  ]],
Cell[76319, 1851, 1337, 20, 88, "Text",ExpressionUUID->"19acb1f6-a13e-472e-a092-c816020202ca"],
Cell[77659, 1873, 1460, 37, 114, "Input",ExpressionUUID->"5afea56c-5e00-4a92-a2e0-2dc4310e842c"]
}, Closed]],
Cell[CellGroupData[{
Cell[79156, 1915, 571, 10, 78, "Section",ExpressionUUID->"6f7a1548-1e50-4501-a22e-815dfaa99b62"],
Cell[79730, 1927, 668, 11, 88, "Text",ExpressionUUID->"aa924584-64d5-447c-ae93-5074d60e8308"],
Cell[80401, 1940, 993, 14, 53, "Text",ExpressionUUID->"a100edb8-d151-4d9d-b8c5-f5f7593ff439"],
Cell[81397, 1956, 975, 19, 46, "Input",ExpressionUUID->"31093a27-8ec5-4f7d-ae26-5f63779d0c49"],
Cell[82375, 1977, 1012, 14, 53, "Text",ExpressionUUID->"adafbbc3-84a9-4f57-9b05-4d8a8e0b385c"],
Cell[83390, 1993, 873, 23, 46, "Input",ExpressionUUID->"149d527a-1ff4-4297-bcbc-273410c3a3c9"],
Cell[84266, 2018, 510, 8, 53, "Text",ExpressionUUID->"55afa87c-7ceb-4386-a20b-8495eabe1fb9"],
Cell[84779, 2028, 1093, 27, 78, "Input",ExpressionUUID->"c900a262-b4ff-4389-96ff-30c557a26f2a"],
Cell[85875, 2057, 1145, 16, 53, "Text",ExpressionUUID->"a8e3bcf6-2d9e-43d0-97cd-2952adba3402"],
Cell[87023, 2075, 883, 23, 49, "Input",ExpressionUUID->"6d3f20b5-bc9a-4f11-8099-944b5c7348b3"],
Cell[87909, 2100, 492, 8, 53, "Text",ExpressionUUID->"94510c21-564e-43fc-95de-959fa91fe74b"],
Cell[88404, 2110, 461, 11, 46, "Input",ExpressionUUID->"9c28f0b2-ad29-44e3-af9b-04a726069b9b"],
Cell[88868, 2123, 541, 9, 53, "Text",ExpressionUUID->"645717a8-a5a8-4a26-8865-878b85e8ac53"],
Cell[89412, 2134, 2164, 49, 78, "Input",ExpressionUUID->"1116eb96-15b6-49eb-b6b2-ece5abc8b0af"],
Cell[91579, 2185, 564, 9, 53, "Text",ExpressionUUID->"8f47a48e-1df7-4cda-a998-ac0e7f8aa15e"],
Cell[92146, 2196, 532, 13, 78, "Input",ExpressionUUID->"770e2ed9-b233-4aa1-9c06-478020ce6f9c"],
Cell[92681, 2211, 1267, 36, 78, "Input",ExpressionUUID->"e933962d-a3c4-470c-8dfc-8d99cad0414d"],
Cell[93951, 2249, 4208, 102, 202, "Input",ExpressionUUID->"30ef33a2-6119-4da2-a093-76fb4be707d2"],
Cell[98162, 2353, 687, 13, 53, "Text",ExpressionUUID->"7f4594a6-ce95-4e2b-9fa4-0318964b80da"],
Cell[98852, 2368, 573, 10, 46, "Input",ExpressionUUID->"69e803c2-ca11-4809-a87e-c5cb650ad803"],
Cell[99428, 2380, 1494, 38, 70, "Input",ExpressionUUID->"4006aa70-0198-4ac4-8fa5-33839c25b208"],
Cell[100925, 2420, 611, 10, 53, "Text",ExpressionUUID->"ffe7d859-3a57-4f27-adb3-857a754d6d49"],
Cell[CellGroupData[{
Cell[101561, 2434, 2663, 68, 202, "Input",ExpressionUUID->"0d9a619b-400b-4e25-8f4a-3a23cb7d69c8"],
Cell[104227, 2504, 907, 14, 52, "Output",ExpressionUUID->"86a6cf65-58f6-4b16-a868-9366cb5a616c"]
}, Open  ]],
Cell[105149, 2521, 1498, 22, 53, "Text",ExpressionUUID->"a96dc72c-30ec-47ff-9fb3-48354bde89f7"],
Cell[106650, 2545, 2796, 74, 184, "Input",ExpressionUUID->"c3a2e477-be51-4536-9fa1-633e4080f3cb"],
Cell[109449, 2621, 711, 13, 53, "Text",ExpressionUUID->"fc0e03a7-8fbc-4085-8445-6a4082325a20"],
Cell[CellGroupData[{
Cell[110185, 2638, 9465, 256, 768, "Input",ExpressionUUID->"237bba53-75eb-4381-a073-d18490eb4922"],
Cell[119653, 2896, 566, 9, 52, "Output",ExpressionUUID->"ad168bf7-ed66-445f-a6ec-6fe161676879"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[120268, 2911, 611, 11, 135, "Section",ExpressionUUID->"010ee68e-0776-47b0-8af7-33f8d637fed0"],
Cell[120882, 2924, 1475, 22, 122, "Text",ExpressionUUID->"64a8f4f8-56c5-47fb-a358-558d27cc0f6e"],
Cell[122360, 2948, 723, 13, 88, "Text",ExpressionUUID->"96bf995c-036e-4965-9122-a625502073e3"],
Cell[123086, 2963, 949, 14, 53, "Text",ExpressionUUID->"afb66459-6e2a-4784-8415-400af7af1dae"],
Cell[124038, 2979, 2956, 42, 46, "Input",ExpressionUUID->"3360d7b9-95b3-49bd-9ef0-2c3bcc8cbf49"],
Cell[126997, 3023, 901, 16, 53, "Text",ExpressionUUID->"155b9e2b-7348-4046-9c0e-317da4ced647"],
Cell[127901, 3041, 444, 12, 78, "Input",ExpressionUUID->"ad858825-d361-4880-ba08-d18c65ddbe24"],
Cell[128348, 3055, 1049, 15, 53, "Text",ExpressionUUID->"cddba3bc-b1ce-40a8-b73f-f7c28e8d41ef"],
Cell[129400, 3072, 3865, 85, 312, "Input",ExpressionUUID->"8064fffe-e3cd-4cf3-8859-ad0f1a465be9"],
Cell[133268, 3159, 552, 10, 53, "Text",ExpressionUUID->"c1d504a4-9483-464a-99db-940909abf85e"],
Cell[133823, 3171, 1020, 24, 78, "Input",ExpressionUUID->"b6eacda9-6d77-4e8e-8676-95461d853a65"],
Cell[134846, 3197, 548, 9, 53, "Text",ExpressionUUID->"061a1bb3-1e25-48e9-8502-8982d180d22f"],
Cell[135397, 3208, 4245, 102, 280, "Input",ExpressionUUID->"8955b129-da1c-463a-9767-ebf1db6bca93"],
Cell[139645, 3312, 564, 9, 53, "Text",ExpressionUUID->"ca5f9261-18b2-45a3-b7bc-d2a178fcbacc"],
Cell[140212, 3323, 532, 13, 78, "Input",ExpressionUUID->"46fd5ce9-834c-4069-971b-83fd20663240"],
Cell[140747, 3338, 1920, 49, 109, "Input",ExpressionUUID->"1807f0fd-7885-4446-844e-5fc9617d46fa"],
Cell[CellGroupData[{
Cell[142692, 3391, 4798, 114, 233, "Input",ExpressionUUID->"c9f30975-ae4a-490b-83c5-3a0fa30d9d2b"],
Cell[147493, 3507, 519, 9, 52, "Output",ExpressionUUID->"e3c13d2e-e698-455c-b159-c41ca9c6ec94"],
Cell[148015, 3518, 519, 9, 52, "Output",ExpressionUUID->"920364a4-18c7-4516-8fa7-059d5d42639c"]
}, Open  ]],
Cell[148549, 3530, 582, 10, 53, "Text",ExpressionUUID->"9681adf1-e0d9-41c0-8e52-28cc5c7cd957"],
Cell[CellGroupData[{
Cell[149156, 3544, 2720, 69, 202, "Input",ExpressionUUID->"0e6a5f92-1432-4aef-9ce3-ebae4899aa09"],
Cell[151879, 3615, 1066, 16, 52, "Output",ExpressionUUID->"533df4d0-c4b9-4922-8b2f-4847c3d0c93f"]
}, Open  ]],
Cell[152960, 3634, 1498, 22, 53, "Text",ExpressionUUID->"816c149b-156f-4dbd-bc22-30e2183443d5"],
Cell[154461, 3658, 6941, 173, 436, "Input",ExpressionUUID->"c9b263c5-d064-4ed7-8530-4ff49fcf8645"],
Cell[161405, 3833, 689, 13, 53, "Text",ExpressionUUID->"13ef5296-2d2d-4c6f-8fc6-93c73caa3e63"],
Cell[CellGroupData[{
Cell[162119, 3850, 11719, 309, 968, "Input",ExpressionUUID->"d867f330-b76b-41e9-af86-675c003fa9b4"],
Cell[173841, 4161, 624, 9, 52, "Output",ExpressionUUID->"ce0fcf1b-bcea-4f47-97bf-fdae54650cc7"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[174514, 4176, 532, 8, 78, "Section",ExpressionUUID->"b4d33f05-0702-46f2-b5ee-3ae6625df8c9"],
Cell[CellGroupData[{
Cell[175071, 4188, 2653, 69, 244, "Input",ExpressionUUID->"06d700c5-15e8-49ef-b8ea-612562fcc284"],
Cell[177727, 4259, 112139, 2597, 632, "Output",ExpressionUUID->"53e6f192-997e-4440-ae56-b15d297a3fc9"]
}, Open  ]],
Cell[289881, 6859, 152, 3, 46, "Input",ExpressionUUID->"311814c3-c0ea-41c7-8eb9-55224c33ede8"]
}, Closed]]
}, Open  ]]
}
]
*)

